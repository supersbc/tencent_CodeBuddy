# Data ç›®å½•è¯´æ˜

æœ¬ç›®å½•ç”¨äºå­˜å‚¨å®éªŒæ•°æ®å’ŒIoTDBè¿è¡Œæ—¶æ•°æ®ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
data/
â”œâ”€â”€ confignode/          # IoTDBé…ç½®èŠ‚ç‚¹æ•°æ®ï¼ˆDockerè¿è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ datanode1/           # IoTDBæ•°æ®èŠ‚ç‚¹1æ•°æ®ï¼ˆDockerè¿è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ datanode2/           # IoTDBæ•°æ®èŠ‚ç‚¹2æ•°æ®ï¼ˆDockerè¿è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ datanode3/           # IoTDBæ•°æ®èŠ‚ç‚¹3æ•°æ®ï¼ˆDockerè¿è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ raw_logs/            # åŸå§‹æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ parsed_logs/         # è§£æåçš„æ—¥å¿—ï¼ˆDrainç®—æ³•è¾“å‡ºï¼‰
â”œâ”€â”€ results/             # å®éªŒç»“æœæ•°æ®
â”œâ”€â”€ metrics/             # æ€§èƒ½æŒ‡æ ‡æ•°æ®
â”œâ”€â”€ prometheus/          # Prometheusæ—¶åºæ•°æ®ï¼ˆDockerè¿è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆï¼‰
â””â”€â”€ grafana/             # Grafanaé…ç½®å’Œä»ªè¡¨æ¿ï¼ˆDockerè¿è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆï¼‰
```

## ğŸ“Š æ•°æ®è¯´æ˜

### 1. IoTDBæ•°æ®ç›®å½•

å½“è¿è¡Œ `docker-compose up` æ—¶ï¼Œä»¥ä¸‹ç›®å½•ä¼šè‡ªåŠ¨å¡«å……ï¼š

- **confignode/**: å­˜å‚¨é›†ç¾¤é…ç½®ä¿¡æ¯
- **datanode1-3/**: å­˜å‚¨æ—¶åºæ•°æ®ã€WALã€ç´¢å¼•ç­‰
- **prometheus/**: å­˜å‚¨ç›‘æ§æŒ‡æ ‡æ—¶åºæ•°æ®
- **grafana/**: å­˜å‚¨ä»ªè¡¨æ¿é…ç½®

### 2. å®éªŒæ•°æ®ç›®å½•

è¿è¡Œå®éªŒæ—¶ä¼šç”Ÿæˆï¼š

- **raw_logs/**: ä»IoTDBæ”¶é›†çš„åŸå§‹æ—¥å¿—æ–‡ä»¶
  - æ ¼å¼: `iotdb-datanode-{id}-{timestamp}.log`
  
- **parsed_logs/**: Drainç®—æ³•è§£æåçš„ç»“æ„åŒ–æ—¥å¿—
  - æ ¼å¼: JSONæˆ–CSV
  - åŒ…å«: log_template_id, parameters, timestamp
  
- **results/**: å®éªŒç»“æœ
  - é˜ˆå€¼å®éªŒç»“æœ
  - æ¨¡å‹è®­ç»ƒç»“æœ
  - è¯„ä¼°æŒ‡æ ‡
  
- **metrics/**: æ€§èƒ½æŒ‡æ ‡
  - ååé‡æ•°æ®
  - CPU/å†…å­˜ä½¿ç”¨ç‡
  - æ—¥å¿—ä½“ç§¯ç»Ÿè®¡

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### æŸ¥çœ‹IoTDBæ•°æ®å¤§å°

```bash
# æŸ¥çœ‹å„èŠ‚ç‚¹æ•°æ®å¤§å°
du -sh data/datanode*

# æŸ¥çœ‹æ€»æ•°æ®å¤§å°
du -sh data/
```

### æ¸…ç†æ•°æ®

```bash
# æ¸…ç†IoTDBæ•°æ®ï¼ˆéœ€è¦å…ˆåœæ­¢å®¹å™¨ï¼‰
docker-compose down
rm -rf data/confignode/* data/datanode*/* data/prometheus/* data/grafana/*

# æ¸…ç†å®éªŒæ•°æ®
rm -rf data/raw_logs/* data/parsed_logs/* data/results/* data/metrics/*
```

### å¤‡ä»½æ•°æ®

```bash
# å¤‡ä»½å®éªŒç»“æœ
tar -czf results_backup_$(date +%Y%m%d).tar.gz data/results/

# å¤‡ä»½IoTDBæ•°æ®
tar -czf iotdb_backup_$(date +%Y%m%d).tar.gz data/confignode/ data/datanode*/
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç£ç›˜ç©ºé—´**: IoTDBæ•°æ®å¯èƒ½ä¼šå¿«é€Ÿå¢é•¿ï¼Œå»ºè®®é¢„ç•™è‡³å°‘50GBç©ºé—´
2. **æƒé™é—®é¢˜**: Dockerå®¹å™¨å¯èƒ½ä»¥ä¸åŒç”¨æˆ·è¿è¡Œï¼Œæ³¨æ„æ–‡ä»¶æƒé™
3. **æ•°æ®æŒä¹…åŒ–**: è¿™äº›ç›®å½•å·²åœ¨ `.gitignore` ä¸­ï¼Œä¸ä¼šæäº¤åˆ°Git
4. **å®šæœŸæ¸…ç†**: å»ºè®®å®šæœŸæ¸…ç†æ—§çš„å®éªŒæ•°æ®

## ğŸ“ˆ é¢„æœŸæ•°æ®é‡

æ ¹æ®è®ºæ–‡å®éªŒé…ç½®ï¼š

- **TSBSæ•°æ®é›†**: ~10GBåŸå§‹æ•°æ®
- **IoTDBå­˜å‚¨**: ~5-6GBï¼ˆå‹ç¼©åï¼‰
- **æ—¥å¿—æ–‡ä»¶**: ~500MB - 2GBï¼ˆå–å†³äºæ—¥å¿—çº§åˆ«ï¼‰
- **å®éªŒç»“æœ**: ~100MB
- **æ€»è®¡**: çº¦15-20GB

---

*ç›®å½•åˆ›å»ºæ—¶é—´: 2025-11-02*
*çŠ¶æ€: å·²åˆ›å»ºï¼Œç­‰å¾…å®éªŒæ•°æ®*
