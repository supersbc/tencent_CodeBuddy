# TDSQL 系统完整使用指南 v4.0

## 🎯 系统概述

TDSQL 部署资源预测系统现已整合所有功能模块，提供完整的解决方案。

## 📍 访问地址

### 主要页面

1. **导航页面**: http://127.0.0.1:5173/nav
   - 所有功能模块的入口
   - 推荐从这里开始

2. **部署资源预测** (主页): http://127.0.0.1:5173/
   - 最新的v4.0版本
   - 详细的设备清单和成本分析
   - 文件上传功能已修复

3. **模型库管理**: http://127.0.0.1:5173/model_library
   - 管理自定义模型库
   - 创建行业专用配置

4. **学习系统**: http://127.0.0.1:5173/learning
   - 提交实际案例
   - 训练和优化模型

5. **融合版页面**: http://127.0.0.1:5173/unified
   - v3.2版本
   - 手动输入与文件上传融合

6. **优化版页面**: http://127.0.0.1:5173/optimized
   - v3.0版本
   - 性能优化版

7. **经典版页面**: http://127.0.0.1:5173/old
   - 原始版本
   - 保留所有经典功能

## 🔧 文件上传功能说明

### 已修复的问题

✅ **文件识别功能已完全修复**

- JSON文件：直接解析参数
- Excel文件：自动识别参数映射
- 图片文件：OCR识别（如果安装了pytesseract）或基础图像分析
- PDF文件：提取文本并解析参数

### 支持的文件格式

| 格式 | 扩展名 | 识别方式 | 状态 |
|------|--------|----------|------|
| JSON | .json | 直接解析 | ✅ 完全支持 |
| Excel | .xlsx, .xls | 表格解析 | ✅ 完全支持 |
| 图片 | .png, .jpg, .jpeg, .gif, .bmp | OCR识别 | ✅ 支持（需安装OCR） |
| PDF | .pdf | 文本提取 | ✅ 完全支持 |
| 文本 | .txt | 正则匹配 | ✅ 完全支持 |

### 使用方法

#### 方法1：拖拽上传
1. 打开主页面
2. 将文件拖拽到上传区域
3. 系统自动识别并提取参数
4. 参数自动填充到表单（带高亮动画）
5. 可手动修改参数
6. 点击"开始预测"

#### 方法2：点击上传
1. 点击上传区域
2. 选择文件
3. 其余步骤同上

### 文件格式示例

#### JSON格式
```json
{
  "qps": 5000,
  "tps": 1500,
  "data_volume": 500,
  "concurrent_users": 1000,
  "data_growth_rate": 0.3,
  "ha_level": "high",
  "industry": "finance"
}
```

#### Excel格式

| 参数名称 | 参数值 |
|---------|--------|
| QPS | 5000 |
| TPS | 1500 |
| 数据量(GB) | 500 |
| 并发用户数 | 1000 |
| 数据增长率 | 0.3 |
| 高可用级别 | high |
| 行业 | 金融 |

#### 图片/PDF格式

文本内容示例：
```
业务需求分析

QPS: 5000
TPS: 1500
数据量: 500 GB
并发用户数: 1000
行业: 金融
高可用级别: 高
```

## 📊 功能模块详解

### 1. 部署资源预测 (主页)

#### 输入参数
- **QPS** (必填) - 每秒查询数
- **数据量** (必填) - 当前数据总量(GB)
- **高可用级别** (必填) - 高/中/低
- TPS - 每秒事务数
- 并发用户数
- 数据增长率
- 行业类型
- 峰值QPS

#### 输出结果（7个标签页）

**1. 概览**
- 系统规模
- QPS/数据量
- 服务器数量
- 初始投资
- 3年TCO

**2. 架构设计**
- 架构类型
- 拓扑配置
- 高可用配置

**3. 设备清单**
- 服务器清单（型号、CPU、内存、存储、网络、价格、功耗）
- 网络设备清单（交换机、防火墙、负载均衡器、路由器）
- 存储设备清单（SSD/HDD、容量、IOPS、吞吐量）
- 基础设施清单（机柜、PDU、UPS、网线）

**4. 网络拓扑**
- 8层网络架构
- VLAN划分
- 设备连接关系

**5. 成本分析**
- 硬件成本
- 软件许可证
- 服务费用
- 年度运营成本
- 3年TCO

**6. 架构图**
- 可视化拓扑
- 节点和连接

**7. 部署建议**
- 性能优化
- 高可用
- 监控运维
- 安全加固
- 数据备份
- 容量规划

### 2. 模型库管理

#### 功能
- 查看所有模型库
- 创建新模型库
- 编辑模型库
- 删除模型库
- 导入/导出模型库

#### 使用场景
- 金融行业专用配置
- 电商行业专用配置
- 游戏行业专用配置
- 自定义行业配置

### 3. 学习系统

#### 功能
- 提交实际案例
- 查看训练历史
- 模型统计信息
- 准确度分析

#### 使用流程
1. 输入业务参数
2. 获取预测结果
3. 输入实际部署结果
4. 提交案例
5. 系统自动学习

## 🚀 快速开始

### 1. 启动服务

```bash
cd /Users/aladdin/Documents/gitdata/tencent_CodeBuddy/aladdinsun/AIdatabase
python3 app.py
```

### 2. 访问导航页面

打开浏览器访问: http://127.0.0.1:5173/nav

### 3. 选择功能模块

根据需求选择相应的功能模块

### 4. 开始使用

按照页面提示操作即可

## 🔍 API接口文档

### 部署预测API

#### 预测接口
```
POST /api/predict
Content-Type: application/json

{
  "qps": 5000,
  "data_volume": 500,
  "ha_level": "high"
}
```

#### 文件上传接口
```
POST /api/upload
Content-Type: multipart/form-data

file: <文件>
```

### 模型库API

#### 获取模型库列表
```
GET /api/model_libraries
```

#### 创建模型库
```
POST /api/model_libraries
Content-Type: application/json

{
  "name": "金融行业模型",
  "description": "专用于金融行业",
  "parameters": {...}
}
```

### 学习系统API

#### 获取训练案例
```
GET /api/training/cases
```

#### 添加训练案例
```
POST /api/training/cases
Content-Type: application/json

{
  "input": {...},
  "output": {...}
}
```

#### 获取训练统计
```
GET /api/training/stats
```

### 健康检查API

```
GET /api/health

Response:
{
  "status": "healthy",
  "version": "4.0",
  "timestamp": "2025-10-26T15:00:00",
  "modules_loaded": true,
  "features": {
    "deployment_prediction": true,
    "model_library": true,
    "learning_system": true
  }
}
```

## 🐛 故障排查

### 问题1: 文件上传无响应

**解决方案**:
1. 检查文件格式是否支持
2. 检查文件大小（最大32MB）
3. 查看浏览器控制台错误
4. 查看服务器日志

### 问题2: OCR识别失败

**原因**: pytesseract未安装

**解决方案**:
```bash
# macOS
brew install tesseract
pip3 install pytesseract

# Ubuntu
sudo apt-get install tesseract-ocr
pip3 install pytesseract
```

**备注**: 即使OCR未安装，系统也会降级到基础图像分析，不影响其他功能

### 问题3: 模块加载失败

**解决方案**:
```bash
# 安装所有依赖
pip3 install Flask openpyxl Pillow PyPDF2 pytesseract Werkzeug
```

### 问题4: 端口被占用

**解决方案**:
```bash
# 查找并杀死占用端口的进程
lsof -ti:5173 | xargs kill -9

# 重新启动服务
python3 app.py
```

## 📝 更新日志

### v4.0 (2025-10-26)

✅ **已修复**:
- 文件上传识别功能完全修复
- OCR降级机制优化
- Excel解析增强
- PDF文本提取改进

✅ **已添加**:
- 导航页面
- 所有功能模块整合
- 完整的API文档
- 健康检查接口

✅ **已保留**:
- 模型库管理功能
- 学习系统功能
- 所有旧版页面
- 向后兼容性

## 🎯 最佳实践

### 1. 文件上传建议

- **JSON文件**: 最准确，推荐使用
- **Excel文件**: 适合批量参数，需要按模板格式
- **图片文件**: 适合扫描件，需要清晰的文字
- **PDF文件**: 适合文档，需要可提取的文本

### 2. 参数输入建议

- QPS和数据量是最重要的参数
- 高可用级别直接影响架构设计
- 数据增长率影响容量规划
- 行业类型影响优化建议

### 3. 结果使用建议

- 设备清单可直接用于采购
- 成本分析可用于预算申请
- 网络拓扑可用于网络规划
- 部署建议可用于实施指导

## 📞 技术支持

如有问题，请：
1. 查看本文档
2. 查看服务器日志: `tail -f server.log`
3. 查看浏览器控制台
4. 联系技术支持团队

## 🎉 总结

v4.0版本是一个**完整的、功能齐全的**系统：

✅ **部署资源预测** - 详细的设备清单和成本分析
✅ **模型库管理** - 自定义行业配置
✅ **学习系统** - 智能优化和训练
✅ **文件上传** - 多格式支持，识别准确
✅ **多版本共存** - 保留所有历史功能
✅ **完整API** - 支持集成和自动化

**所有功能都已就绪，可以开始使用！** 🚀

---

**版本**: v4.0  
**更新日期**: 2025-10-26  
**状态**: ✅ 生产就绪
