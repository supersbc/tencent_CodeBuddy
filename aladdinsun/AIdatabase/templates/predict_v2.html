<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TDSQL éƒ¨ç½²èµ„æºé¢„æµ‹ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        /* è¿”å›å¯¼èˆªæŒ‰é’® */
        .back-nav-btn {
            position: absolute;
            top: 0;
            left: 0;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .back-nav-btn:hover {
            background: white;
            color: #667eea;
            transform: translateX(-5px);
        }

        /* ç‰ˆæœ¬åˆ‡æ¢ */
        .version-switch {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .version-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .version-tab {
            flex: 1;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: white;
        }

        .version-tab:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .version-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .version-tab h3 {
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .version-tab p {
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* æ¨¡æ¿ä¸‹è½½åŒºåŸŸ */
        .template-download {
            display: flex;
            gap: 15px;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .template-download-btn {
            padding: 12px 24px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .template-download-btn:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .template-info {
            flex: 1;
            font-size: 0.9em;
            color: #666;
        }

        /* ä¸»å¡ç‰‡ */
        .main-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .input-section {
            padding: 30px;
        }

        .form-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-icon {
            font-size: 1.5em;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group small {
            margin-top: 5px;
            color: #999;
            font-size: 0.85em;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-group label {
            margin: 0;
            cursor: pointer;
        }

        /* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */
        .file-upload-area {
            border: 2px dashed #667eea;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-upload-area:hover {
            background: #e9ecef;
            border-color: #764ba2;
        }

        .file-upload-area.dragover {
            background: #e7f3ff;
            border-color: #007bff;
        }

        .file-info {
            margin-top: 15px;
            padding: 15px;
            background: #d4edda;
            border-radius: 8px;
            display: none;
        }

        .file-info.show {
            display: block;
        }

        /* æŒ‰é’® */
        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ç»“æœåŒºåŸŸ */
        .results-section {
            display: none;
            padding: 30px;
            background: #f8f9fa;
        }

        .results-section.show {
            display: block;
        }

        .result-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .result-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .result-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .result-item label {
            font-size: 0.9em;
            color: #666;
            display: block;
            margin-bottom: 5px;
        }

        .result-item value {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
        }

        /* è¿”å›é¡¶éƒ¨æŒ‰é’® */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #667eea;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .back-to-top:hover {
            background: #764ba2;
            transform: translateY(-5px);
        }

        .back-to-top.show {
            display: flex;
        }

        /* è¡¨æ ¼æ ·å¼ä¼˜åŒ– */
        table {
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        table th {
            font-weight: 600;
            color: white;
        }

        table tbody tr:hover {
            background: #f8f9fa;
        }

        /* æ‰“å°æ ·å¼ */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .header, .back-nav-btn, .version-switch, .back-to-top {
                display: none !important;
            }

            .container {
                max-width: 100%;
            }

            .input-section {
                display: none !important;
            }

            .results-section {
                display: block !important;
                box-shadow: none;
            }

            .result-card {
                page-break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
                margin-bottom: 20px;
            }

            table {
                page-break-inside: avoid;
                font-size: 11px;
            }

            .btn {
                display: none !important;
            }

            h2, h3 {
                color: #333 !important;
            }
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }

            .version-tabs {
                flex-direction: column;
            }

            .btn-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="/" class="back-nav-btn">
                <span>â†</span>
                <span>è¿”å›å¯¼èˆª</span>
            </a>
            <h1>ğŸš€ TDSQL éƒ¨ç½²èµ„æºé¢„æµ‹ç³»ç»Ÿ</h1>
            <p>æ™ºèƒ½åˆ†æ Â· ç²¾å‡†é¢„æµ‹ Â· ä¸“ä¸šå»ºè®®</p>
        </div>

        <!-- ç‰ˆæœ¬åˆ‡æ¢ -->
        <div class="version-switch">
            <div class="version-tabs">
                <div class="version-tab active" data-version="basic">
                    <h3>ğŸ“ æ™®é€šç‰ˆ</h3>
                    <p>å¿«é€Ÿé¢„æµ‹ï¼Œé€‚åˆä¸€èˆ¬åœºæ™¯</p>
                </div>
                <div class="version-tab" data-version="professional">
                    <h3>âš™ï¸ ä¸“ä¸šç‰ˆ</h3>
                    <p>è¯¦ç»†é…ç½®ï¼Œé€‚åˆå¤æ‚åœºæ™¯</p>
                </div>
            </div>

            <div class="template-download">
                <button class="template-download-btn" id="downloadTemplateBtn">
                    <span>ğŸ“¥</span>
                    <span>ä¸‹è½½Excelæ¨¡æ¿</span>
                </button>
                <div class="template-info">
                    <strong>æç¤ºï¼š</strong>ä¸‹è½½æ¨¡æ¿åå¡«å†™å‚æ•°ï¼Œç„¶åä¸Šä¼ Excelæ–‡ä»¶è‡ªåŠ¨å¡«å……è¡¨å•
                </div>
            </div>
        </div>

        <!-- ä¸»å¡ç‰‡ -->
        <div class="main-card">
            <div class="input-section">
                <!-- æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ -->
                <div class="form-section">
                    <div class="section-title">
                        <span class="section-icon">ğŸ“¤</span>
                        <span>Excelæ–‡ä»¶ä¸Šä¼ ï¼ˆå¯é€‰ï¼‰</span>
                    </div>
                    <div class="file-upload-area" id="fileUploadArea">
                        <div style="font-size: 3em; margin-bottom: 10px;">ğŸ“„</div>
                        <p style="font-size: 1.1em; margin-bottom: 5px;">ç‚¹å‡»æˆ–æ‹–æ‹½Excelæ–‡ä»¶åˆ°æ­¤å¤„</p>
                        <p style="font-size: 0.9em; color: #999;">æ”¯æŒ .xlsx å’Œ .xls æ ¼å¼</p>
                        <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">
                    </div>
                    <div class="file-info" id="fileInfo">
                        <strong>âœ… æ–‡ä»¶å·²ä¸Šä¼ ï¼š</strong><span id="fileName"></span>
                        <button onclick="clearFile()" style="margin-left: 15px; padding: 5px 15px; background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer;">æ¸…é™¤</button>
                    </div>
                </div>

                <!-- æ™®é€šç‰ˆè¡¨å• -->
                <form id="basicForm" style="display: block;">
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ“Š</span>
                            <span>æ•°æ®è§„æ¨¡</span>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>æ•°æ®è§„æ¨¡ (GB) *</label>
                                <input type="number" name="total_data_size_gb" required min="1">
                                <small>é¢„è®¡å­˜å‚¨çš„æ€»æ•°æ®é‡</small>
                            </div>
                            <div class="form-group">
                                <label>è¡¨æ•°é‡ *</label>
                                <input type="number" name="table_count" required min="1">
                                <small>æ•°æ®åº“ä¸­çš„è¡¨æ€»æ•°</small>
                            </div>
                            <div class="form-group">
                                <label>æ•°æ®å¢é•¿ç‡ (%/å¹´) *</label>
                                <input type="number" name="data_growth_rate" required min="0" max="100">
                                <small>é¢„è®¡æ¯å¹´æ•°æ®å¢é•¿çš„ç™¾åˆ†æ¯”</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">âš¡</span>
                            <span>æ€§èƒ½éœ€æ±‚</span>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>QPS (æ¯ç§’æŸ¥è¯¢æ•°) *</label>
                                <input type="number" name="qps" required min="1">
                                <small>ç³»ç»Ÿæ¯ç§’å¤„ç†çš„æŸ¥è¯¢è¯·æ±‚æ•°</small>
                            </div>
                            <div class="form-group">
                                <label>TPS (æ¯ç§’äº‹åŠ¡æ•°) *</label>
                                <input type="number" name="tps" required min="1">
                                <small>ç³»ç»Ÿæ¯ç§’å¤„ç†çš„äº‹åŠ¡æ•°</small>
                            </div>
                            <div class="form-group">
                                <label>å¹¶å‘è¿æ¥æ•° *</label>
                                <input type="number" name="concurrent_connections" required min="1">
                                <small>åŒæ—¶è¿æ¥åˆ°æ•°æ®åº“çš„æœ€å¤§è¿æ¥æ•°</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ›¡ï¸</span>
                            <span>é«˜å¯ç”¨é…ç½®</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_high_availability" id="ha">
                                <label for="ha">éœ€è¦é«˜å¯ç”¨æ¶æ„</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_disaster_recovery" id="dr">
                                <label for="dr">éœ€è¦å¼‚åœ°ç¾å¤‡</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_read_write_split" id="rw">
                                <label for="rw">éœ€è¦è¯»å†™åˆ†ç¦»</label>
                            </div>
                        </div>
                    </div>

                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">ğŸš€ å¼€å§‹é¢„æµ‹</button>
                        <button type="reset" class="btn btn-secondary">ğŸ”„ é‡ç½®è¡¨å•</button>
                    </div>
                </form>

                <!-- ä¸“ä¸šç‰ˆè¡¨å• -->
                <form id="professionalForm" style="display: none;">
                    <!-- åŸºç¡€ä¿¡æ¯ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ“‹</span>
                            <span>åŸºç¡€ä¿¡æ¯</span>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>é¡¹ç›®åç§°</label>
                                <input type="text" name="project_name">
                            </div>
                            <div class="form-group">
                                <label>è¡Œä¸šç±»å‹</label>
                                <select name="industry_type">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="finance">é‡‘è</option>
                                    <option value="ecommerce">ç”µå•†</option>
                                    <option value="gaming">æ¸¸æˆ</option>
                                    <option value="internet">äº’è”ç½‘</option>
                                    <option value="government">æ”¿åŠ¡</option>
                                    <option value="healthcare">åŒ»ç–—</option>
                                    <option value="education">æ•™è‚²</option>
                                    <option value="other">å…¶ä»–</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>ä¸šåŠ¡åœºæ™¯</label>
                                <input type="text" name="business_scenario" placeholder="å¦‚ï¼šæ ¸å¿ƒäº¤æ˜“ã€æ•°æ®åˆ†æç­‰">
                            </div>
                            <div class="form-group">
                                <label>é¢„è®¡ä¸Šçº¿æ—¶é—´</label>
                                <input type="date" name="launch_date">
                            </div>
                            <div class="form-group">
                                <label>é¢„ç®—èŒƒå›´ (ä¸‡å…ƒ)</label>
                                <input type="number" name="budget_range" min="0">
                            </div>
                        </div>
                    </div>

                    <!-- æ•°æ®è§„æ¨¡ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ“Š</span>
                            <span>æ•°æ®è§„æ¨¡</span>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>å½“å‰æ•°æ®è§„æ¨¡ (GB) *</label>
                                <input type="number" name="current_data_size_gb" required min="0">
                            </div>
                            <div class="form-group">
                                <label>é¢„è®¡3å¹´åæ•°æ®è§„æ¨¡ (GB)</label>
                                <input type="number" name="future_data_size_gb" min="0">
                            </div>
                            <div class="form-group">
                                <label>æ•°æ®åº“æ•°é‡</label>
                                <input type="number" name="database_count" min="1">
                            </div>
                            <div class="form-group">
                                <label>è¡¨æ•°é‡ *</label>
                                <input type="number" name="table_count" required min="1">
                            </div>
                            <div class="form-group">
                                <label>å•è¡¨æœ€å¤§è®°å½•æ•°</label>
                                <input type="number" name="max_table_rows" min="0">
                            </div>
                            <div class="form-group">
                                <label>å¹³å‡è¡Œå¤§å° (å­—èŠ‚)</label>
                                <input type="number" name="avg_row_size" min="0">
                            </div>
                            <div class="form-group">
                                <label>æ•°æ®å¢é•¿ç‡ (%/å¹´) *</label>
                                <input type="number" name="data_growth_rate" required min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label>æ•°æ®ä¿ç•™æœŸé™ (å¹´)</label>
                                <input type="number" name="data_retention_years" min="1">
                            </div>
                        </div>
                    </div>

                    <!-- æ€§èƒ½éœ€æ±‚ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">âš¡</span>
                            <span>æ€§èƒ½éœ€æ±‚</span>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>æ—¥å¸¸QPS *</label>
                                <input type="number" name="normal_qps" required min="1">
                            </div>
                            <div class="form-group">
                                <label>å³°å€¼QPS</label>
                                <input type="number" name="peak_qps" min="1">
                            </div>
                            <div class="form-group">
                                <label>æ—¥å¸¸TPS *</label>
                                <input type="number" name="normal_tps" required min="1">
                            </div>
                            <div class="form-group">
                                <label>å³°å€¼TPS</label>
                                <input type="number" name="peak_tps" min="1">
                            </div>
                            <div class="form-group">
                                <label>å¹³å‡å¹¶å‘è¿æ¥æ•° *</label>
                                <input type="number" name="avg_concurrent_connections" required min="1">
                            </div>
                            <div class="form-group">
                                <label>å³°å€¼å¹¶å‘è¿æ¥æ•°</label>
                                <input type="number" name="peak_concurrent_connections" min="1">
                            </div>
                            <div class="form-group">
                                <label>å¹³å‡å“åº”æ—¶é—´è¦æ±‚ (ms)</label>
                                <input type="number" name="avg_response_time" min="0">
                            </div>
                            <div class="form-group">
                                <label>99åˆ†ä½å“åº”æ—¶é—´è¦æ±‚ (ms)</label>
                                <input type="number" name="p99_response_time" min="0">
                            </div>
                            <div class="form-group">
                                <label>è¯»å†™æ¯”ä¾‹</label>
                                <input type="text" name="read_write_ratio" placeholder="å¦‚ï¼š7:3">
                            </div>
                        </div>
                    </div>

                    <!-- é«˜å¯ç”¨ä¸ç¾å¤‡ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ›¡ï¸</span>
                            <span>é«˜å¯ç”¨ä¸ç¾å¤‡</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_high_availability" id="ha_pro">
                                <label for="ha_pro">éœ€è¦é«˜å¯ç”¨æ¶æ„</label>
                            </div>
                            <div class="form-group">
                                <label>å¯ç”¨æ€§è¦æ±‚</label>
                                <select name="availability_requirement">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="99.9">99.9%</option>
                                    <option value="99.99">99.99%</option>
                                    <option value="99.999">99.999%</option>
                                </select>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_disaster_recovery" id="dr_pro">
                                <label for="dr_pro">éœ€è¦å¼‚åœ°ç¾å¤‡</label>
                            </div>
                            <div class="form-group">
                                <label>RPO (æ¢å¤ç‚¹ç›®æ ‡)</label>
                                <input type="text" name="rpo" placeholder="å¦‚ï¼š0ã€5åˆ†é’Ÿã€1å°æ—¶">
                            </div>
                            <div class="form-group">
                                <label>RTO (æ¢å¤æ—¶é—´ç›®æ ‡)</label>
                                <input type="text" name="rto" placeholder="å¦‚ï¼š5åˆ†é’Ÿã€30åˆ†é’Ÿ">
                            </div>
                            <div class="form-group">
                                <label>ç¾å¤‡ä¸­å¿ƒæ•°é‡</label>
                                <input type="number" name="dr_center_count" min="0">
                            </div>
                            <div class="form-group">
                                <label>ä¸»å¤‡åˆ‡æ¢æ–¹å¼</label>
                                <select name="failover_mode">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="auto">è‡ªåŠ¨</option>
                                    <option value="manual">æ‰‹åŠ¨</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- æ¶æ„åå¥½ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ—ï¸</span>
                            <span>æ¶æ„åå¥½</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_read_write_split" id="rw_pro">
                                <label for="rw_pro">éœ€è¦è¯»å†™åˆ†ç¦»</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_sharding" id="sharding">
                                <label for="sharding">éœ€è¦åˆ†åº“åˆ†è¡¨</label>
                            </div>
                            <div class="form-group">
                                <label>åˆ†ç‰‡ç­–ç•¥</label>
                                <input type="text" name="sharding_strategy" placeholder="å¦‚ï¼šæŒ‰ç”¨æˆ·IDã€æŒ‰æ—¶é—´ç­‰">
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_cache" id="cache">
                                <label for="cache">éœ€è¦ç¼“å­˜å±‚</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_mq" id="mq">
                                <label for="mq">éœ€è¦æ¶ˆæ¯é˜Ÿåˆ—</label>
                            </div>
                            <div class="form-group">
                                <label>éƒ¨ç½²æ–¹å¼</label>
                                <select name="deployment_mode">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="physical">ç‰©ç†æœº</option>
                                    <option value="vm">è™šæ‹Ÿæœº</option>
                                    <option value="container">å®¹å™¨</option>
                                    <option value="cloud_native">äº‘åŸç”Ÿ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>ç½‘ç»œéš”ç¦»è¦æ±‚</label>
                                <input type="text" name="network_isolation" placeholder="å¦‚ï¼šVPCã€ä¸“çº¿ç­‰">
                            </div>
                        </div>
                    </div>

                    <!-- å®‰å…¨ä¸åˆè§„ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ”’</span>
                            <span>å®‰å…¨ä¸åˆè§„</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_encryption" id="encryption">
                                <label for="encryption">éœ€è¦æ•°æ®åŠ å¯†</label>
                            </div>
                            <div class="form-group">
                                <label>åŠ å¯†æ–¹å¼</label>
                                <select name="encryption_type">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="transport">ä¼ è¾“åŠ å¯†</option>
                                    <option value="storage">å­˜å‚¨åŠ å¯†</option>
                                    <option value="full">å…¨åŠ å¯†</option>
                                </select>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_audit" id="audit">
                                <label for="audit">éœ€è¦å®¡è®¡æ—¥å¿—</label>
                            </div>
                            <div class="form-group">
                                <label>åˆè§„è¦æ±‚</label>
                                <input type="text" name="compliance" placeholder="å¦‚ï¼šç­‰ä¿ä¸‰çº§ã€PCI-DSSç­‰">
                            </div>
                            <div class="form-group">
                                <label>æ•æ„Ÿæ•°æ®ç±»å‹</label>
                                <input type="text" name="sensitive_data" placeholder="å¦‚ï¼šèº«ä»½è¯ã€é“¶è¡Œå¡ç­‰">
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_masking" id="masking">
                                <label for="masking">éœ€è¦æ•°æ®è„±æ•</label>
                            </div>
                        </div>
                    </div>

                    <!-- è¿ç»´éœ€æ±‚ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ”§</span>
                            <span>è¿ç»´éœ€æ±‚</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_monitoring" id="monitoring">
                                <label for="monitoring">éœ€è¦ç›‘æ§å‘Šè­¦</label>
                            </div>
                            <div class="form-group">
                                <label>å¤‡ä»½é¢‘ç‡</label>
                                <select name="backup_frequency">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="realtime">å®æ—¶</option>
                                    <option value="hourly">æ¯å°æ—¶</option>
                                    <option value="daily">æ¯å¤©</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>å¤‡ä»½ä¿ç•™æœŸé™ (å¤©)</label>
                                <input type="number" name="backup_retention_days" min="1">
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_auto_scaling" id="auto_scaling">
                                <label for="auto_scaling">éœ€è¦è‡ªåŠ¨æ‰©å®¹</label>
                            </div>
                            <div class="form-group">
                                <label>è¿ç»´å›¢é˜Ÿè§„æ¨¡</label>
                                <input type="number" name="ops_team_size" min="0">
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_24x7_support" id="support">
                                <label for="support">éœ€è¦7x24å°æ—¶æ”¯æŒ</label>
                            </div>
                        </div>
                    </div>

                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">ğŸš€ å¼€å§‹é¢„æµ‹</button>
                        <button type="reset" class="btn btn-secondary">ğŸ”„ é‡ç½®è¡¨å•</button>
                    </div>
                </form>

                <!-- åŠ è½½åŠ¨ç”» -->
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>æ­£åœ¨åˆ†æé¢„æµ‹ä¸­ï¼Œè¯·ç¨å€™...</p>
                </div>
            </div>

            <!-- ç»“æœåŒºåŸŸ -->
            <div class="results-section" id="resultsSection">
                <h2 style="text-align: center; color: #667eea; margin-bottom: 30px;">ğŸ“Š é¢„æµ‹ç»“æœ</h2>
                <div id="resultsContent"></div>
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="location.reload()">ğŸ”„ é‡æ–°é¢„æµ‹</button>
                </div>
            </div>
        </div>
    </div>

    <!-- è¿”å›é¡¶éƒ¨ -->
    <div class="back-to-top" id="backToTop" onclick="scrollToTop()">
        â†‘
    </div>

    <script>
        // ç‰ˆæœ¬åˆ‡æ¢
        const versionTabs = document.querySelectorAll('.version-tab');
        const basicForm = document.getElementById('basicForm');
        const professionalForm = document.getElementById('professionalForm');
        let currentVersion = 'basic';

        versionTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                versionTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                currentVersion = tab.dataset.version;
                if (currentVersion === 'basic') {
                    basicForm.style.display = 'block';
                    professionalForm.style.display = 'none';
                } else {
                    basicForm.style.display = 'none';
                    professionalForm.style.display = 'block';
                }
            });
        });

        // ä¸‹è½½æ¨¡æ¿
        document.getElementById('downloadTemplateBtn').addEventListener('click', () => {
            const templateName = currentVersion === 'basic' ? 
                'éƒ¨ç½²èµ„æºé¢„æµ‹æ¨¡æ¿-æ™®é€šç‰ˆ.xlsx' : 
                'éƒ¨ç½²èµ„æºé¢„æµ‹æ¨¡æ¿-ä¸“ä¸šç‰ˆ.xlsx';
            
            window.location.href = `/download_template/${currentVersion}`;
        });

        // æ–‡ä»¶ä¸Šä¼ 
        const fileUploadArea = document.getElementById('fileUploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');

        fileUploadArea.addEventListener('click', () => fileInput.click());

        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.classList.add('dragover');
        });

        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.classList.remove('dragover');
        });

        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        function handleFile(file) {
            if (!file.name.match(/\.(xlsx|xls)$/)) {
                alert('è¯·ä¸Šä¼ Excelæ–‡ä»¶ï¼ˆ.xlsxæˆ–.xlsæ ¼å¼ï¼‰');
                return;
            }

            fileName.textContent = file.name;
            fileInfo.classList.add('show');

            // ä¸Šä¼ æ–‡ä»¶å¹¶è§£æ
            const formData = new FormData();
            formData.append('file', file);

            fetch('/api/parse_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    fillFormWithData(data.data);
                    alert('âœ… Excelæ•°æ®å·²æˆåŠŸå¡«å……åˆ°è¡¨å•ï¼');
                } else {
                    alert('âŒ è§£æå¤±è´¥ï¼š' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('âŒ ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•');
            });
        }

        function clearFile() {
            fileInput.value = '';
            fileInfo.classList.remove('show');
            fileName.textContent = '';
        }

        function fillFormWithData(data) {
            const form = currentVersion === 'basic' ? basicForm : professionalForm;
            
            for (const [key, value] of Object.entries(data)) {
                const input = form.querySelector(`[name="${key}"]`);
                if (input) {
                    if (input.type === 'checkbox') {
                        input.checked = value === true || value === 'TRUE' || value === 'true';
                    } else {
                        input.value = value;
                    }
                }
            }
        }

        // è¡¨å•æäº¤
        [basicForm, professionalForm].forEach(form => {
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const formData = new FormData(form);
                const data = {};
                
                for (const [key, value] of formData.entries()) {
                    const input = form.querySelector(`[name="${key}"]`);
                    if (input.type === 'checkbox') {
                        data[key] = input.checked;
                    } else if (input.type === 'number') {
                        data[key] = parseFloat(value) || 0;
                    } else {
                        data[key] = value;
                    }
                }

                // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
                document.getElementById('loading').classList.add('show');
                document.querySelector('.input-section').style.display = 'none';

                try {
                    const response = await fetch('/api/predict', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });

                    const result = await response.json();
                    
                    if (result.success) {
                        displayResults(result.data);
                    } else {
                        alert('é¢„æµ‹å¤±è´¥ï¼š' + result.error);
                        location.reload();
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('é¢„æµ‹å¤±è´¥ï¼Œè¯·é‡è¯•');
                    location.reload();
                }
            });
        });

        function displayResults(r) {
            document.getElementById('loading').classList.remove('show');
            document.getElementById('resultsSection').classList.add('show');
            
            // ç»Ÿä¸€ç»“æœæ˜ å°„ï¼ˆå…¼å®¹åç«¯è¿”å›çš„å­—æ®µç»“æ„ï¼‰
            const arch = r.architecture || {};
            const topo = arch.topology || {};
            const cost = (r.cost_breakdown && r.cost_breakdown.summary) ? r.cost_breakdown.summary : {};
            const equipment = r.equipment_list || {};
            const costBreakdown = (r.cost_breakdown && r.cost_breakdown.breakdown) ? r.cost_breakdown.breakdown : {};
            
            const mapped = {
                architecture_type: arch.type || 'unknown',
                node_count: (topo.db_nodes || 0) + (topo.app_nodes || 0) + (topo.proxy_nodes || 0) + (topo.monitor_nodes || 0),
                shard_count: topo.shard_count || 0,
                replica_count: topo.replica_count || 0,
                total_cost: cost.three_year_tco || cost.initial_investment || 0,
                hardware_cost: cost.total_hardware || 0,
                software_cost: cost.total_software || 0,
                ops_cost: cost.annual_operating || 0,
            };
            
            const resultsContent = document.getElementById('resultsContent');
            
            // ç”ŸæˆæœåŠ¡å™¨æ¸…å•HTML
            let serversHTML = '';
            if (equipment.servers && equipment.servers.length > 0) {
                serversHTML = `
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <thead>
                            <tr style="background: #f5f7fa; border-bottom: 2px solid #667eea;">
                                <th style="padding: 12px; text-align: left;">ç¼–å·</th>
                                <th style="padding: 12px; text-align: left;">è§’è‰²</th>
                                <th style="padding: 12px; text-align: left;">å‹å·</th>
                                <th style="padding: 12px; text-align: left;">CPU</th>
                                <th style="padding: 12px; text-align: left;">å†…å­˜</th>
                                <th style="padding: 12px; text-align: left;">å­˜å‚¨</th>
                                <th style="padding: 12px; text-align: left;">ç½‘ç»œ</th>
                                <th style="padding: 12px; text-align: right;">å•ä»·(Â¥)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${equipment.servers.map(s => `
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px;">${s.id}</td>
                                    <td style="padding: 10px;">${s.role}</td>
                                    <td style="padding: 10px;">${s.model}</td>
                                    <td style="padding: 10px;">${s.cpu}</td>
                                    <td style="padding: 10px;">${s.memory}</td>
                                    <td style="padding: 10px;">${s.disk}</td>
                                    <td style="padding: 10px;">${s.network}</td>
                                    <td style="padding: 10px; text-align: right;">${Number(s.unit_price).toLocaleString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                        <tfoot>
                            <tr style="background: #f5f7fa; font-weight: bold;">
                                <td colspan="7" style="padding: 12px; text-align: right;">æœåŠ¡å™¨å°è®¡ï¼š</td>
                                <td style="padding: 12px; text-align: right;">Â¥${Number(equipment.servers.reduce((sum, s) => sum + s.total_price, 0)).toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
            }
            
            // ç”Ÿæˆç½‘ç»œè®¾å¤‡æ¸…å•HTML
            let networkHTML = '';
            if (equipment.network_devices && equipment.network_devices.length > 0) {
                networkHTML = `
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <thead>
                            <tr style="background: #f5f7fa; border-bottom: 2px solid #667eea;">
                                <th style="padding: 12px; text-align: left;">ç¼–å·</th>
                                <th style="padding: 12px; text-align: left;">ç±»å‹</th>
                                <th style="padding: 12px; text-align: left;">å‹å·</th>
                                <th style="padding: 12px; text-align: left;">è§„æ ¼</th>
                                <th style="padding: 12px; text-align: center;">æ•°é‡</th>
                                <th style="padding: 12px; text-align: right;">å•ä»·(Â¥)</th>
                                <th style="padding: 12px; text-align: right;">å°è®¡(Â¥)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${equipment.network_devices.map(n => `
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px;">${n.id}</td>
                                    <td style="padding: 10px;">${n.type}</td>
                                    <td style="padding: 10px;">${n.model}</td>
                                    <td style="padding: 10px;">${n.ports || n.throughput || '-'}</td>
                                    <td style="padding: 10px; text-align: center;">${n.quantity}</td>
                                    <td style="padding: 10px; text-align: right;">${Number(n.unit_price).toLocaleString()}</td>
                                    <td style="padding: 10px; text-align: right;">${Number(n.total_price).toLocaleString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                        <tfoot>
                            <tr style="background: #f5f7fa; font-weight: bold;">
                                <td colspan="6" style="padding: 12px; text-align: right;">ç½‘ç»œè®¾å¤‡å°è®¡ï¼š</td>
                                <td style="padding: 12px; text-align: right;">Â¥${Number(equipment.network_devices.reduce((sum, n) => sum + n.total_price, 0)).toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
            }
            
            // ç”Ÿæˆå­˜å‚¨è®¾å¤‡æ¸…å•HTML
            let storageHTML = '';
            if (equipment.storage && equipment.storage.length > 0) {
                storageHTML = `
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <thead>
                            <tr style="background: #f5f7fa; border-bottom: 2px solid #667eea;">
                                <th style="padding: 12px; text-align: left;">ç±»å‹</th>
                                <th style="padding: 12px; text-align: left;">å‹å·</th>
                                <th style="padding: 12px; text-align: center;">å®¹é‡(TB)</th>
                                <th style="padding: 12px; text-align: center;">IOPS</th>
                                <th style="padding: 12px; text-align: center;">ååé‡</th>
                                <th style="padding: 12px; text-align: right;">å•ä»·/TB(Â¥)</th>
                                <th style="padding: 12px; text-align: right;">å°è®¡(Â¥)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${equipment.storage.map(s => `
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px;">${s.type}</td>
                                    <td style="padding: 10px;">${s.model}</td>
                                    <td style="padding: 10px; text-align: center;">${s.capacity_tb}</td>
                                    <td style="padding: 10px; text-align: center;">${Number(s.iops).toLocaleString()}</td>
                                    <td style="padding: 10px; text-align: center;">${s.throughput}</td>
                                    <td style="padding: 10px; text-align: right;">${Number(s.unit_price_per_tb).toLocaleString()}</td>
                                    <td style="padding: 10px; text-align: right;">${Number(s.total_price).toLocaleString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                        <tfoot>
                            <tr style="background: #f5f7fa; font-weight: bold;">
                                <td colspan="6" style="padding: 12px; text-align: right;">å­˜å‚¨è®¾å¤‡å°è®¡ï¼š</td>
                                <td style="padding: 12px; text-align: right;">Â¥${Number(equipment.storage.reduce((sum, s) => sum + s.total_price, 0)).toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
            }
            
            // ç”ŸæˆåŸºç¡€è®¾æ–½æ¸…å•HTML
            let infraHTML = '';
            if (equipment.infrastructure && equipment.infrastructure.length > 0) {
                infraHTML = `
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <thead>
                            <tr style="background: #f5f7fa; border-bottom: 2px solid #667eea;">
                                <th style="padding: 12px; text-align: left;">ç±»å‹</th>
                                <th style="padding: 12px; text-align: center;">æ•°é‡/å®¹é‡</th>
                                <th style="padding: 12px; text-align: right;">å•ä»·(Â¥)</th>
                                <th style="padding: 12px; text-align: right;">å°è®¡(Â¥)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${equipment.infrastructure.map(i => `
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px;">${i.type}</td>
                                    <td style="padding: 10px; text-align: center;">${i.quantity || i.capacity_kw || '-'}</td>
                                    <td style="padding: 10px; text-align: right;">${Number(i.unit_price).toLocaleString()}</td>
                                    <td style="padding: 10px; text-align: right;">${Number(i.total_price).toLocaleString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                        <tfoot>
                            <tr style="background: #f5f7fa; font-weight: bold;">
                                <td colspan="3" style="padding: 12px; text-align: right;">åŸºç¡€è®¾æ–½å°è®¡ï¼š</td>
                                <td style="padding: 12px; text-align: right;">Â¥${Number(equipment.infrastructure.reduce((sum, i) => sum + i.total_price, 0)).toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
            }
            
            // ç”Ÿæˆè¯¦ç»†æŠ¥ä»·å•HTML
            let quotationHTML = '';
            if (costBreakdown.hardware || costBreakdown.software || costBreakdown.services) {
                quotationHTML = `
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <thead>
                            <tr style="background: #667eea; color: white; border-bottom: 2px solid #667eea;">
                                <th style="padding: 12px; text-align: left;">ç±»åˆ«</th>
                                <th style="padding: 12px; text-align: left;">é¡¹ç›®</th>
                                <th style="padding: 12px; text-align: right;">é‡‘é¢(Â¥)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${costBreakdown.hardware ? `
                                <tr style="background: #f9f9f9; font-weight: bold;">
                                    <td colspan="3" style="padding: 10px;">ç¡¬ä»¶æˆæœ¬</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">æœåŠ¡å™¨</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.hardware.servers || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">ç½‘ç»œè®¾å¤‡</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.hardware.network_devices || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">å­˜å‚¨è®¾å¤‡</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.hardware.storage || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">åŸºç¡€è®¾æ–½</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.hardware.infrastructure || 0).toLocaleString()}</td>
                                </tr>
                            ` : ''}
                            ${costBreakdown.software ? `
                                <tr style="background: #f9f9f9; font-weight: bold;">
                                    <td colspan="3" style="padding: 10px;">è½¯ä»¶è®¸å¯è¯</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">TDSQLä¼ä¸šç‰ˆè®¸å¯è¯</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.software.tdsql_license || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">æ“ä½œç³»ç»Ÿè®¸å¯è¯</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.software.os_license || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">ç›‘æ§è½¯ä»¶</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.software.monitoring || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">å¤‡ä»½è½¯ä»¶</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.software.backup || 0).toLocaleString()}</td>
                                </tr>
                            ` : ''}
                            ${costBreakdown.services ? `
                                <tr style="background: #f9f9f9; font-weight: bold;">
                                    <td colspan="3" style="padding: 10px;">å®æ–½æœåŠ¡</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">éƒ¨ç½²å®æ–½è´¹ç”¨</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.services.deployment || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">æŠ€æœ¯åŸ¹è®­</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.services.training || 0).toLocaleString()}</td>
                                </tr>
                            ` : ''}
                            ${costBreakdown.annual_operating ? `
                                <tr style="background: #f9f9f9; font-weight: bold;">
                                    <td colspan="3" style="padding: 10px;">å¹´åº¦è¿è¥æˆæœ¬</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">ç”µåŠ›æˆæœ¬</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.annual_operating.power || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">åˆ¶å†·æˆæœ¬</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.annual_operating.cooling || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 10px; padding-left: 30px;"></td>
                                    <td style="padding: 10px;">ç»´æŠ¤æˆæœ¬</td>
                                    <td style="padding: 10px; text-align: right;">${Number(costBreakdown.annual_operating.maintenance || 0).toLocaleString()}</td>
                                </tr>
                            ` : ''}
                        </tbody>
                        <tfoot>
                            <tr style="background: #667eea; color: white; font-weight: bold; font-size: 16px;">
                                <td colspan="2" style="padding: 15px; text-align: right;">åˆå§‹æŠ•èµ„æ€»é¢ï¼š</td>
                                <td style="padding: 15px; text-align: right;">Â¥${Number(cost.initial_investment || 0).toLocaleString()}</td>
                            </tr>
                            <tr style="background: #764ba2; color: white; font-weight: bold; font-size: 16px;">
                                <td colspan="2" style="padding: 15px; text-align: right;">ä¸‰å¹´TCOæ€»æˆæœ¬ï¼š</td>
                                <td style="padding: 15px; text-align: right;">Â¥${Number(cost.three_year_tco || 0).toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
            }
            
            resultsContent.innerHTML = `
                <div class="result-card">
                    <h3>ğŸ—ï¸ æ¶æ„æ–¹æ¡ˆ</h3>
                    <div class="result-grid">
                        <div class="result-item">
                            <label>æ¶æ„ç±»å‹</label>
                            <value>${arch.description || mapped.architecture_type}</value>
                        </div>
                        <div class="result-item">
                            <label>æ€»èŠ‚ç‚¹æ•°</label>
                            <value>${mapped.node_count}</value>
                        </div>
                        <div class="result-item">
                            <label>åˆ†ç‰‡æ•°é‡</label>
                            <value>${mapped.shard_count}</value>
                        </div>
                        <div class="result-item">
                            <label>å‰¯æœ¬æ•°é‡</label>
                            <value>${mapped.replica_count}</value>
                        </div>
                    </div>
                    <div class="result-grid" style="margin-top: 15px;">
                        <div class="result-item">
                            <label>æ•°æ®åº“èŠ‚ç‚¹</label>
                            <value>${topo.db_nodes || 0}</value>
                        </div>
                        <div class="result-item">
                            <label>ä»£ç†èŠ‚ç‚¹</label>
                            <value>${topo.proxy_nodes || 0}</value>
                        </div>
                        <div class="result-item">
                            <label>åº”ç”¨èŠ‚ç‚¹</label>
                            <value>${topo.app_nodes || 0}</value>
                        </div>
                        <div class="result-item">
                            <label>ç›‘æ§/å¤‡ä»½èŠ‚ç‚¹</label>
                            <value>${(topo.monitor_nodes || 0) + (topo.backup_nodes || 0)}</value>
                        </div>
                    </div>
                </div>

                <div class="result-card">
                    <h3>ğŸ’° æˆæœ¬æ€»è§ˆ</h3>
                    <div class="result-grid">
                        <div class="result-item">
                            <label>åˆå§‹æŠ•èµ„</label>
                            <value style="color: #667eea; font-size: 20px; font-weight: bold;">Â¥${Number(cost.initial_investment || 0).toLocaleString()}</value>
                        </div>
                        <div class="result-item">
                            <label>ä¸‰å¹´TCO</label>
                            <value style="color: #764ba2; font-size: 20px; font-weight: bold;">Â¥${Number(mapped.total_cost).toLocaleString()}</value>
                        </div>
                        <div class="result-item">
                            <label>å¹´åº¦è¿è¥æˆæœ¬</label>
                            <value>Â¥${Number(mapped.ops_cost).toLocaleString()}</value>
                        </div>
                        <div class="result-item">
                            <label>æœˆåº¦è¿è¥æˆæœ¬</label>
                            <value>Â¥${Number(cost.monthly_operating || 0).toLocaleString()}</value>
                        </div>
                    </div>
                </div>

                <div class="result-card">
                    <h3>ğŸ–¥ï¸ æœåŠ¡å™¨é…ç½®æ¸…å•</h3>
                    <p style="color: #666; margin-bottom: 10px;">å…± ${equipment.servers ? equipment.servers.length : 0} å°æœåŠ¡å™¨</p>
                    ${serversHTML}
                </div>

                <div class="result-card">
                    <h3>ğŸŒ ç½‘ç»œè®¾å¤‡æ¸…å•</h3>
                    <p style="color: #666; margin-bottom: 10px;">å…± ${equipment.network_devices ? equipment.network_devices.length : 0} å°ç½‘ç»œè®¾å¤‡</p>
                    ${networkHTML}
                </div>

                <div class="result-card">
                    <h3>ğŸ’¾ å­˜å‚¨è®¾å¤‡æ¸…å•</h3>
                    ${storageHTML}
                </div>

                <div class="result-card">
                    <h3>ğŸ¢ åŸºç¡€è®¾æ–½æ¸…å•</h3>
                    ${infraHTML}
                </div>

                <div class="result-card">
                    <h3>ğŸ“Š è¯¦ç»†æŠ¥ä»·å•</h3>
                    ${quotationHTML}
                </div>

                <div class="result-card">
                    <h3>ğŸ“¥ å¯¼å‡ºé€‰é¡¹</h3>
                    <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                        <button class="btn btn-primary" onclick="exportToExcel()">ğŸ“„ å¯¼å‡ºExcelæŠ¥ä»·å•</button>
                        <button class="btn btn-secondary" onclick="exportToPDF()">ğŸ“‘ å¯¼å‡ºPDFæ–¹æ¡ˆä¹¦</button>
                        <button class="btn btn-secondary" onclick="window.print()">ğŸ–¨ï¸ æ‰“å°æŠ¥å‘Š</button>
                    </div>
                </div>
            `;

            // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        }
        
        // å¯¼å‡ºExcelåŠŸèƒ½
        function exportToExcel() {
            alert('Excelå¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼');
            // TODO: å®ç°Excelå¯¼å‡º
        }
        
        // å¯¼å‡ºPDFåŠŸèƒ½
        function exportToPDF() {
            alert('PDFå¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼');
            // TODO: å®ç°PDFå¯¼å‡º
        }

        // è¿”å›é¡¶éƒ¨
        window.addEventListener('scroll', () => {
            const backToTop = document.getElementById('backToTop');
            if (window.pageYOffset > 300) {
                backToTop.classList.add('show');
            } else {
                backToTop.classList.remove('show');
            }
        });

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
