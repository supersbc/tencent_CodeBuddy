<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>TDSQL éƒ¨ç½²èµ„æºé¢„æµ‹ç³»ç»Ÿ v2.1</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        /* è¿”å›å¯¼èˆªæŒ‰é’® */
        .back-nav-btn {
            position: absolute;
            top: 0;
            left: 0;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .back-nav-btn:hover {
            background: white;
            color: #667eea;
            transform: translateX(-5px);
        }

        /* ç‰ˆæœ¬åˆ‡æ¢ */
        .version-switch {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .version-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .version-tab {
            flex: 1;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: white;
        }

        .version-tab:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .version-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .version-tab h3 {
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .version-tab p {
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* æ¨¡æ¿ä¸‹è½½åŒºåŸŸ */
        .template-download {
            display: flex;
            gap: 15px;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .template-download-btn {
            padding: 12px 24px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .template-download-btn:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .template-info {
            flex: 1;
            font-size: 0.9em;
            color: #666;
        }

        /* ä¸»å¡ç‰‡ */
        .main-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .input-section {
            padding: 30px;
        }

        .form-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-icon {
            font-size: 1.5em;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group small {
            margin-top: 5px;
            color: #999;
            font-size: 0.85em;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-group label {
            margin: 0;
            cursor: pointer;
        }

        /* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */
        .file-upload-area {
            border: 2px dashed #667eea;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-upload-area:hover {
            background: #e9ecef;
            border-color: #764ba2;
        }

        .file-upload-area.dragover {
            background: #e7f3ff;
            border-color: #007bff;
        }

        .file-info {
            margin-top: 15px;
            padding: 15px;
            background: #d4edda;
            border-radius: 8px;
            display: none;
        }

        .file-info.show {
            display: block;
        }

        /* æŒ‰é’® */
        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ç»“æœåŒºåŸŸ */
        .results-section {
            display: none;
            padding: 30px;
            background: #f8f9fa;
        }

        .results-section.show {
            display: block;
        }

        .result-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .result-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .result-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .result-item label {
            font-size: 0.9em;
            color: #666;
            display: block;
            margin-bottom: 5px;
        }

        .result-item value {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
        }

        /* è¿”å›é¡¶éƒ¨æŒ‰é’® */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #667eea;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .back-to-top:hover {
            background: #764ba2;
            transform: translateY(-5px);
        }

        .back-to-top.show {
            display: flex;
        }

        /* è¡¨æ ¼æ ·å¼ä¼˜åŒ– */
        table {
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        table th {
            font-weight: 600;
            color: white;
        }

        table tbody tr:hover {
            background: #f8f9fa;
        }

        /* æ‰“å°æ ·å¼ */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .header, .back-nav-btn, .version-switch, .back-to-top {
                display: none !important;
            }

            .container {
                max-width: 100%;
            }

            .input-section {
                display: none !important;
            }

            .results-section {
                display: block !important;
                box-shadow: none;
            }

            .result-card {
                page-break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
                margin-bottom: 20px;
            }

            table {
                page-break-inside: avoid;
                font-size: 11px;
            }

            .btn {
                display: none !important;
            }

            h2, h3 {
                color: #333 !important;
            }
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }

            .version-tabs {
                flex-direction: column;
            }

            .btn-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="/" class="back-nav-btn">
                <span>â†</span>
                <span>è¿”å›å¯¼èˆª</span>
            </a>
            <h1>ğŸš€ TDSQL éƒ¨ç½²èµ„æºé¢„æµ‹ç³»ç»Ÿ</h1>
            <p>æ™ºèƒ½åˆ†æ Â· ç²¾å‡†é¢„æµ‹ Â· ä¸“ä¸šå»ºè®®</p>
        </div>

        <!-- ç‰ˆæœ¬åˆ‡æ¢ -->
        <div class="version-switch">
            <div class="version-tabs">
                <div class="version-tab active" data-version="basic">
                    <h3>ğŸ“ æ™®é€šç‰ˆ</h3>
                    <p>å¿«é€Ÿé¢„æµ‹ï¼Œé€‚åˆä¸€èˆ¬åœºæ™¯</p>
                </div>
                <div class="version-tab" data-version="professional">
                    <h3>âš™ï¸ ä¸“ä¸šç‰ˆ</h3>
                    <p>è¯¦ç»†é…ç½®ï¼Œé€‚åˆå¤æ‚åœºæ™¯</p>
                </div>
            </div>

            <div class="template-download">
                <button class="template-download-btn" id="downloadTemplateBtn">
                    <span>ğŸ“¥</span>
                    <span>ä¸‹è½½Excelæ¨¡æ¿</span>
                </button>
                <div class="template-info">
                    <strong>æç¤ºï¼š</strong>ä¸‹è½½æ¨¡æ¿åå¡«å†™å‚æ•°ï¼Œç„¶åä¸Šä¼ Excelæ–‡ä»¶è‡ªåŠ¨å¡«å……è¡¨å•
                </div>
            </div>
        </div>

        <!-- ä¸»å¡ç‰‡ -->
        <div class="main-card">
            <div class="input-section">
                <!-- æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ -->
                <div class="form-section">
                    <div class="section-title">
                        <span class="section-icon">ğŸ“¤</span>
                        <span>Excelæ–‡ä»¶ä¸Šä¼ ï¼ˆå¯é€‰ï¼‰</span>
                    </div>
                    <div class="file-upload-area" id="fileUploadArea">
                        <div style="font-size: 3em; margin-bottom: 10px;">ğŸ“„</div>
                        <p style="font-size: 1.1em; margin-bottom: 5px;">ç‚¹å‡»æˆ–æ‹–æ‹½Excelæ–‡ä»¶åˆ°æ­¤å¤„</p>
                        <p style="font-size: 0.9em; color: #999;">æ”¯æŒ .xlsx å’Œ .xls æ ¼å¼</p>
                        <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">
                    </div>
                    <div class="file-info" id="fileInfo">
                        <strong>âœ… æ–‡ä»¶å·²ä¸Šä¼ ï¼š</strong><span id="fileName"></span>
                        <button onclick="clearFile()" style="margin-left: 15px; padding: 5px 15px; background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer;">æ¸…é™¤</button>
                    </div>
                </div>

                <!-- æ™®é€šç‰ˆè¡¨å• -->
                <form id="basicForm" style="display: block;">
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ“Š</span>
                            <span>æ•°æ®è§„æ¨¡</span>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="total_data_size_gb">æ•°æ®è§„æ¨¡ (GB) *</label>
                                <input type="number" name="total_data_size_gb" id="total_data_size_gb" required min="1">
                                <small>é¢„è®¡å­˜å‚¨çš„æ€»æ•°æ®é‡</small>
                            </div>
                            <div class="form-group">
                                <label for="table_count">è¡¨æ•°é‡ *</label>
                                <input type="number" name="table_count" id="table_count" required min="1">
                                <small>æ•°æ®åº“ä¸­çš„è¡¨æ€»æ•°</small>
                            </div>
                            <div class="form-group">
                                <label for="data_growth_rate">æ•°æ®å¢é•¿ç‡ (%/å¹´) *</label>
                                <input type="number" name="data_growth_rate" id="data_growth_rate" required min="0" max="100">
                                <small>é¢„è®¡æ¯å¹´æ•°æ®å¢é•¿çš„ç™¾åˆ†æ¯”</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">âš¡</span>
                            <span>æ€§èƒ½éœ€æ±‚</span>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="qps">QPS (æ¯ç§’æŸ¥è¯¢æ•°) *</label>
                                <input type="number" name="qps" id="qps" required min="1">
                                <small>ç³»ç»Ÿæ¯ç§’å¤„ç†çš„æŸ¥è¯¢è¯·æ±‚æ•°</small>
                            </div>
                            <div class="form-group">
                                <label for="tps">TPS (æ¯ç§’äº‹åŠ¡æ•°) *</label>
                                <input type="number" name="tps" id="tps" required min="1">
                                <small>ç³»ç»Ÿæ¯ç§’å¤„ç†çš„äº‹åŠ¡æ•°</small>
                            </div>
                            <div class="form-group">
                                <label for="concurrent_connections">å¹¶å‘è¿æ¥æ•° *</label>
                                <input type="number" name="concurrent_connections" id="concurrent_connections" required min="1">
                                <small>åŒæ—¶è¿æ¥åˆ°æ•°æ®åº“çš„æœ€å¤§è¿æ¥æ•°</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ›¡ï¸</span>
                            <span>é«˜å¯ç”¨é…ç½®</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group">
                                <input type="checkbox" name="ha" id="ha">
                                <label for="ha">éœ€è¦é«˜å¯ç”¨æ¶æ„</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="dr" id="dr">
                                <label for="dr">éœ€è¦å¼‚åœ°ç¾å¤‡</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="rw" id="rw">
                                <label for="rw">éœ€è¦è¯»å†™åˆ†ç¦»</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ‡¨ğŸ‡³</span>
                            <span>ä¿¡åˆ›å›½äº§åŒ–</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group" style="background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%); border: 2px solid #667eea;">
                                <input type="checkbox" name="enable_xinchuan" id="enable_xinchuan">
                                <label for="enable_xinchuan" style="font-weight: 700; color: #667eea;">âœ¨ å¯ç”¨ä¿¡åˆ›å›½äº§åŒ–å¯¹æ¯”ï¼ˆå¯é€‰ï¼‰</label>
                            </div>
                            <div class="form-group">
                                <label for="xinchuan_mode_simple">ä¿¡åˆ›æ¨¡å¼çº§åˆ«</label>
                                <select name="xinchuan_mode" id="xinchuan_mode_simple">
                                    <option value="standard">æ ‡å‡†ä¿¡åˆ›ï¼ˆæœåŠ¡å™¨+ç½‘ç»œå›½äº§åŒ–ï¼ŒèŠ‚çº¦8-12%ï¼‰</option>
                                    <option value="strict">ä¸¥æ ¼ä¿¡åˆ›ï¼ˆå…¨å›½äº§CPUï¼ŒèŠ‚çº¦10-15%ï¼‰</option>
                                    <option value="full">å®Œå…¨ä¿¡åˆ›ï¼ˆå…¨æ ˆå›½äº§ï¼Œç¬¦åˆå›½å®¶è¦æ±‚ï¼‰</option>
                                </select>
                                <small>ğŸ’¡ ä¿¡åˆ›æ¨¡å¼å°†ä½¿ç”¨æµªæ½®ã€åä¸ºç­‰å›½äº§è®¾å¤‡ï¼Œäº«å—æˆæœ¬ä¼˜åŠ¿å’Œæ”¿ç­–æ”¯æŒ</small>
                            </div>
                        </div>
                    </div>

                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">ğŸš€ å¼€å§‹é¢„æµ‹</button>
                        <button type="reset" class="btn btn-secondary">ğŸ”„ é‡ç½®è¡¨å•</button>
                    </div>
                </form>

                <!-- ä¸“ä¸šç‰ˆè¡¨å• -->
                <form id="professionalForm" style="display: none;">
                    <!-- åŸºç¡€ä¿¡æ¯ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ“‹</span>
                            <span>åŸºç¡€ä¿¡æ¯</span>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="project_name">é¡¹ç›®åç§°</label>
                                <input type="text" name="project_name" id="project_name">
                            </div>
                            <div class="form-group">
                                <label for="industry_pro">è¡Œä¸šç±»å‹</label>
                                <select name="industry" id="industry_pro">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="finance">é‡‘è</option>
                                    <option value="ecommerce">ç”µå•†</option>
                                    <option value="gaming">æ¸¸æˆ</option>
                                    <option value="internet">äº’è”ç½‘</option>
                                    <option value="government">æ”¿åŠ¡</option>
                                    <option value="healthcare">åŒ»ç–—</option>
                                    <option value="education">æ•™è‚²</option>
                                    <option value="other">å…¶ä»–</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="business_scenario">ä¸šåŠ¡åœºæ™¯</label>
                                <input type="text" name="business_scenario" id="business_scenario" placeholder="å¦‚ï¼šæ ¸å¿ƒäº¤æ˜“ã€æ•°æ®åˆ†æç­‰">
                            </div>
                            <div class="form-group">
                                <label for="launch_date">é¢„è®¡ä¸Šçº¿æ—¶é—´</label>
                                <input type="date" name="launch_date" id="launch_date">
                            </div>
                            <div class="form-group">
                                <label for="budget_range">é¢„ç®—èŒƒå›´ (ä¸‡å…ƒ)</label>
                                <input type="number" name="budget_range" id="budget_range" min="0">
                            </div>
                        </div>
                    </div>

                    <!-- æ•°æ®è§„æ¨¡ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ“Š</span>
                            <span>æ•°æ®è§„æ¨¡</span>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="current_data_size_gb">å½“å‰æ•°æ®è§„æ¨¡ (GB) *</label>
                                <input type="number" name="current_data_size_gb" id="current_data_size_gb" required min="0">
                            </div>
                            <div class="form-group">
                                <label for="future_data_size_gb">é¢„è®¡3å¹´åæ•°æ®è§„æ¨¡ (GB)</label>
                                <input type="number" name="future_data_size_gb" id="future_data_size_gb" min="0">
                            </div>
                            <div class="form-group">
                                <label for="database_count">æ•°æ®åº“æ•°é‡</label>
                                <input type="number" name="database_count" id="database_count" min="1">
                            </div>
                            <div class="form-group">
                                <label for="table_count">è¡¨æ•°é‡ *</label>
                                <input type="number" name="table_count" id="table_count" required min="1">
                            </div>
                            <div class="form-group">
                                <label for="max_table_rows">å•è¡¨æœ€å¤§è®°å½•æ•°</label>
                                <input type="number" name="max_table_rows" id="max_table_rows" min="0">
                            </div>
                            <div class="form-group">
                                <label for="avg_row_size">å¹³å‡è¡Œå¤§å° (å­—èŠ‚)</label>
                                <input type="number" name="avg_row_size" id="avg_row_size" min="0">
                            </div>
                            <div class="form-group">
                                <label for="data_growth_rate">æ•°æ®å¢é•¿ç‡ (%/å¹´) *</label>
                                <input type="number" name="data_growth_rate" id="data_growth_rate" required min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="data_retention_years">æ•°æ®ä¿ç•™æœŸé™ (å¹´)</label>
                                <input type="number" name="data_retention_years" id="data_retention_years" min="1">
                            </div>
                        </div>
                    </div>

                    <!-- æ€§èƒ½éœ€æ±‚ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">âš¡</span>
                            <span>æ€§èƒ½éœ€æ±‚</span>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="normal_qps">æ—¥å¸¸QPS *</label>
                                <input type="number" name="normal_qps" id="normal_qps" required min="1">
                            </div>
                            <div class="form-group">
                                <label for="peak_qps">å³°å€¼QPS</label>
                                <input type="number" name="peak_qps" id="peak_qps" min="1">
                            </div>
                            <div class="form-group">
                                <label for="normal_tps">æ—¥å¸¸TPS *</label>
                                <input type="number" name="normal_tps" id="normal_tps" required min="1">
                            </div>
                            <div class="form-group">
                                <label for="peak_tps">å³°å€¼TPS</label>
                                <input type="number" name="peak_tps" id="peak_tps" min="1">
                            </div>
                            <div class="form-group">
                                <label for="avg_concurrent_connections">å¹³å‡å¹¶å‘è¿æ¥æ•° *</label>
                                <input type="number" name="avg_concurrent_connections" id="avg_concurrent_connections" required min="1">
                            </div>
                            <div class="form-group">
                                <label for="peak_concurrent_connections">å³°å€¼å¹¶å‘è¿æ¥æ•°</label>
                                <input type="number" name="peak_concurrent_connections" id="peak_concurrent_connections" min="1">
                            </div>
                            <div class="form-group">
                                <label for="avg_response_time">å¹³å‡å“åº”æ—¶é—´è¦æ±‚ (ms)</label>
                                <input type="number" name="avg_response_time" id="avg_response_time" min="0">
                            </div>
                            <div class="form-group">
                                <label for="p99_response_time">99åˆ†ä½å“åº”æ—¶é—´è¦æ±‚ (ms)</label>
                                <input type="number" name="p99_response_time" id="p99_response_time" min="0">
                            </div>
                            <div class="form-group">
                                <label for="read_write_ratio">è¯»å†™æ¯”ä¾‹</label>
                                <input type="text" name="read_write_ratio" id="read_write_ratio" placeholder="å¦‚ï¼š7:3">
                            </div>
                        </div>
                    </div>

                    <!-- é«˜å¯ç”¨ä¸ç¾å¤‡ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ›¡ï¸</span>
                            <span>é«˜å¯ç”¨ä¸ç¾å¤‡</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_high_availability" id="ha_pro">
                                <label for="ha_pro">éœ€è¦é«˜å¯ç”¨æ¶æ„</label>
                            </div>
                            <div class="form-group">
                                <label for="availability_requirement">å¯ç”¨æ€§è¦æ±‚</label>
                                <select name="availability_requirement" id="availability_requirement">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="99.9">99.9%</option>
                                    <option value="99.99">99.99%</option>
                                    <option value="99.999">99.999%</option>
                                </select>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="dr_pro" id="dr_pro">
                                <label for="dr_pro">éœ€è¦å¼‚åœ°ç¾å¤‡</label>
                            </div>
                            <div class="form-group">
                                <label for="rpo">RPO (æ¢å¤ç‚¹ç›®æ ‡)</label>
                                <input type="text" name="rpo" id="rpo" placeholder="å¦‚ï¼š0ã€5åˆ†é’Ÿã€1å°æ—¶">
                            </div>
                            <div class="form-group">
                                <label for="rto">RTO (æ¢å¤æ—¶é—´ç›®æ ‡)</label>
                                <input type="text" name="rto" id="rto" placeholder="å¦‚ï¼š5åˆ†é’Ÿã€30åˆ†é’Ÿ">
                            </div>
                            <div class="form-group">
                                <label for="dr_center_count">ç¾å¤‡ä¸­å¿ƒæ•°é‡</label>
                                <input type="number" name="dr_center_count" id="dr_center_count" min="0">
                            </div>
                            <div class="form-group">
                                <label for="failover_mode">ä¸»å¤‡åˆ‡æ¢æ–¹å¼</label>
                                <select name="failover_mode" id="failover_mode">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="auto">è‡ªåŠ¨</option>
                                    <option value="manual">æ‰‹åŠ¨</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- æ¶æ„åå¥½ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ—ï¸</span>
                            <span>æ¶æ„åå¥½</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group">
                                <input type="checkbox" name="rw_pro" id="rw_pro">
                                <label for="rw_pro">éœ€è¦è¯»å†™åˆ†ç¦»</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_sharding" id="need_sharding">
                                <label for="need_sharding">éœ€è¦åˆ†åº“åˆ†è¡¨</label>
                            </div>
                            <div class="form-group">
                                <label for="sharding_strategy">åˆ†ç‰‡ç­–ç•¥</label>
                                <input type="text" name="sharding_strategy" id="sharding_strategy" placeholder="å¦‚ï¼šæŒ‰ç”¨æˆ·IDã€æŒ‰æ—¶é—´ç­‰">
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_cache" id="need_cache">
                                <label for="need_cache">éœ€è¦ç¼“å­˜å±‚</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_mq" id="need_mq">
                                <label for="need_mq">éœ€è¦æ¶ˆæ¯é˜Ÿåˆ—</label>
                            </div>
                            <div class="form-group">
                                <label for="deployment_mode">éƒ¨ç½²æ–¹å¼</label>
                                <select name="deployment_mode" id="deployment_mode">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="physical">ç‰©ç†æœº</option>
                                    <option value="vm">è™šæ‹Ÿæœº</option>
                                    <option value="container">å®¹å™¨</option>
                                    <option value="cloud_native">äº‘åŸç”Ÿ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="network_isolation">ç½‘ç»œéš”ç¦»è¦æ±‚</label>
                                <input type="text" name="network_isolation" id="network_isolation" placeholder="å¦‚ï¼šVPCã€ä¸“çº¿ç­‰">
                            </div>
                        </div>
                    </div>

                    <!-- å®‰å…¨ä¸åˆè§„ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ”’</span>
                            <span>å®‰å…¨ä¸åˆè§„</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_encryption" id="need_encryption">
                                <label for="need_encryption">éœ€è¦æ•°æ®åŠ å¯†</label>
                            </div>
                            <div class="form-group">
                                <label for="encryption_type">åŠ å¯†æ–¹å¼</label>
                                <select name="encryption_type" id="encryption_type">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="transport">ä¼ è¾“åŠ å¯†</option>
                                    <option value="storage">å­˜å‚¨åŠ å¯†</option>
                                    <option value="full">å…¨åŠ å¯†</option>
                                </select>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_audit" id="need_audit">
                                <label for="need_audit">éœ€è¦å®¡è®¡æ—¥å¿—</label>
                            </div>
                            <div class="form-group">
                                <label for="compliance">åˆè§„è¦æ±‚</label>
                                <input type="text" name="compliance" id="compliance" placeholder="å¦‚ï¼šç­‰ä¿ä¸‰çº§ã€PCI-DSSç­‰">
                            </div>
                            <div class="form-group">
                                <label for="sensitive_data">æ•æ„Ÿæ•°æ®ç±»å‹</label>
                                <input type="text" name="sensitive_data" id="sensitive_data" placeholder="å¦‚ï¼šèº«ä»½è¯ã€é“¶è¡Œå¡ç­‰">
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_masking" id="need_masking">
                                <label for="need_masking">éœ€è¦æ•°æ®è„±æ•</label>
                            </div>
                        </div>
                    </div>

                    <!-- ä¿¡åˆ›å›½äº§åŒ– -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ‡¨ğŸ‡³</span>
                            <span>ä¿¡åˆ›å›½äº§åŒ–</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group" style="background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%); border: 2px solid #667eea;">
                                <input type="checkbox" name="enable_xinchuan_pro" id="enable_xinchuan_pro">
                                <label for="enable_xinchuan_pro" style="font-weight: 700; color: #667eea;">âœ¨ å¯ç”¨ä¿¡åˆ›å›½äº§åŒ–å¯¹æ¯”ï¼ˆå¯é€‰ï¼‰</label>
                            </div>
                            <div class="form-group">
                                <label for="xinchuan_mode_pro">ä¿¡åˆ›æ¨¡å¼çº§åˆ«</label>
                                <select name="xinchuan_mode" id="xinchuan_mode_pro">
                                    <option value="standard">æ ‡å‡†ä¿¡åˆ›ï¼ˆæœåŠ¡å™¨+ç½‘ç»œå›½äº§åŒ–ï¼ŒèŠ‚çº¦8-12%ï¼‰</option>
                                    <option value="strict">ä¸¥æ ¼ä¿¡åˆ›ï¼ˆå…¨å›½äº§CPUï¼ŒèŠ‚çº¦10-15%ï¼‰</option>
                                    <option value="full">å®Œå…¨ä¿¡åˆ›ï¼ˆå…¨æ ˆå›½äº§ï¼Œç¬¦åˆå›½å®¶è¦æ±‚ï¼‰</option>
                                </select>
                                <small>ğŸ’¡ ä¿¡åˆ›æ¨¡å¼å°†ä½¿ç”¨æµªæ½®ã€åä¸ºç­‰å›½äº§è®¾å¤‡ï¼Œäº«å—æˆæœ¬ä¼˜åŠ¿å’Œæ”¿ç­–æ”¯æŒ</small>
                            </div>
                            <div class="form-group">
                                <label for="xinchuan_vendor_preference">è®¾å¤‡åå¥½</label>
                                <select name="xinchuan_vendor_preference" id="xinchuan_vendor_preference">
                                    <option value="">ä¸é™</option>
                                    <option value="inspur">ä¼˜å…ˆæµªæ½®</option>
                                    <option value="huawei">ä¼˜å…ˆåä¸º</option>
                                    <option value="lenovo">ä¼˜å…ˆè”æƒ³</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- è¿ç»´éœ€æ±‚ -->
                    <div class="form-section">
                        <div class="section-title">
                            <span class="section-icon">ğŸ”§</span>
                            <span>è¿ç»´éœ€æ±‚</span>
                        </div>
                        <div class="form-grid">
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_monitoring" id="need_monitoring">
                                <label for="need_monitoring">éœ€è¦ç›‘æ§å‘Šè­¦</label>
                            </div>
                            <div class="form-group">
                                <label for="backup_frequency">å¤‡ä»½é¢‘ç‡</label>
                                <select name="backup_frequency" id="backup_frequency">
                                    <option value="">è¯·é€‰æ‹©</option>
                                    <option value="realtime">å®æ—¶</option>
                                    <option value="hourly">æ¯å°æ—¶</option>
                                    <option value="daily">æ¯å¤©</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="backup_retention_days">å¤‡ä»½ä¿ç•™æœŸé™ (å¤©)</label>
                                <input type="number" name="backup_retention_days" id="backup_retention_days" min="1">
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_auto_scaling" id="need_auto_scaling">
                                <label for="need_auto_scaling">éœ€è¦è‡ªåŠ¨æ‰©å®¹</label>
                            </div>
                            <div class="form-group">
                                <label for="ops_team_size">è¿ç»´å›¢é˜Ÿè§„æ¨¡</label>
                                <input type="number" name="ops_team_size" id="ops_team_size" min="0">
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" name="need_24x7_support" id="need_24x7_support">
                                <label for="need_24x7_support">éœ€è¦7x24å°æ—¶æ”¯æŒ</label>
                            </div>
                        </div>
                    </div>

                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">ğŸš€ å¼€å§‹é¢„æµ‹</button>
                        <button type="reset" class="btn btn-secondary">ğŸ”„ é‡ç½®è¡¨å•</button>
                    </div>
                </form>

                <!-- åŠ è½½åŠ¨ç”» -->
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>æ­£åœ¨åˆ†æé¢„æµ‹ä¸­ï¼Œè¯·ç¨å€™...</p>
                </div>
            </div>

            <!-- ç»“æœåŒºåŸŸ -->
            <div class="results-section" id="resultsSection">
                <h2 style="text-align: center; color: #667eea; margin-bottom: 30px;">ğŸ“Š é¢„æµ‹ç»“æœ</h2>
                <div id="resultsContent"></div>
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="location.reload()">ğŸ”„ é‡æ–°é¢„æµ‹</button>
                </div>
            </div>
        </div>
    </div>

    <!-- è¿”å›é¡¶éƒ¨ -->
    <div class="back-to-top" id="backToTop" onclick="scrollToTop()">
        â†‘
    </div>

    <script>
        // ç‰ˆæœ¬åˆ‡æ¢
        const versionTabs = document.querySelectorAll('.version-tab');
        const basicForm = document.getElementById('basicForm');
        const professionalForm = document.getElementById('professionalForm');
        let currentVersion = 'basic';

        versionTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                versionTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                currentVersion = tab.dataset.version;
                if (currentVersion === 'basic') {
                    basicForm.style.display = 'block';
                    professionalForm.style.display = 'none';
                } else {
                    basicForm.style.display = 'none';
                    professionalForm.style.display = 'block';
                }
            });
        });

        // ä¸‹è½½æ¨¡æ¿
        document.getElementById('downloadTemplateBtn').addEventListener('click', () => {
            const templateName = currentVersion === 'basic' ? 
                'éƒ¨ç½²èµ„æºé¢„æµ‹æ¨¡æ¿-æ™®é€šç‰ˆ.xlsx' : 
                'éƒ¨ç½²èµ„æºé¢„æµ‹æ¨¡æ¿-ä¸“ä¸šç‰ˆ.xlsx';
            
            window.location.href = `/download_template/${currentVersion}`;
        });

        // æ–‡ä»¶ä¸Šä¼ 
        const fileUploadArea = document.getElementById('fileUploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');

        fileUploadArea.addEventListener('click', () => fileInput.click());

        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.classList.add('dragover');
        });

        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.classList.remove('dragover');
        });

        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        function handleFile(file) {
            if (!file.name.match(/\.(xlsx|xls)$/)) {
                alert('è¯·ä¸Šä¼ Excelæ–‡ä»¶ï¼ˆ.xlsxæˆ–.xlsæ ¼å¼ï¼‰');
                return;
            }

            fileName.textContent = file.name;
            fileInfo.classList.add('show');

            // ä¸Šä¼ æ–‡ä»¶å¹¶è§£æ
            const formData = new FormData();
            formData.append('file', file);

            fetch('/api/parse_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    fillFormWithData(data.data);
                    alert('âœ… Excelæ•°æ®å·²æˆåŠŸå¡«å……åˆ°è¡¨å•ï¼');
                } else {
                    alert('âŒ è§£æå¤±è´¥ï¼š' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('âŒ ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•');
            });
        }

        function clearFile() {
            fileInput.value = '';
            fileInfo.classList.remove('show');
            fileName.textContent = '';
        }

        function fillFormWithData(data) {
            const form = currentVersion === 'basic' ? basicForm : professionalForm;
            
            for (const [key, value] of Object.entries(data)) {
                const input = form.querySelector(`[name="${key}"]`);
                if (input) {
                    if (input.type === 'checkbox') {
                        input.checked = value === true || value === 'TRUE' || value === 'true';
                    } else {
                        input.value = value;
                    }
                }
            }
        }

        // è¡¨å•æäº¤
        [basicForm, professionalForm].forEach(form => {
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const formData = new FormData(form);
                const data = {};
                
                for (const [key, value] of formData.entries()) {
                    const input = form.querySelector(`[name="${key}"]`);
                    if (input.type === 'checkbox') {
                        data[key] = input.checked;
                    } else if (input.type === 'number') {
                        data[key] = parseFloat(value) || 0;
                    } else {
                        data[key] = value;
                    }
                }

                // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
                document.getElementById('loading').classList.add('show');
                document.querySelector('.input-section').style.display = 'none';

                try {
                    const response = await fetch('/api/predict', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });

                    console.log('APIå“åº”çŠ¶æ€:', response.status);
                    
                    // å…ˆè·å–æ–‡æœ¬ï¼Œå†è§£æJSONï¼Œä»¥ä¾¿æ•è·è§£æé”™è¯¯
                    const text = await response.text();
                    console.log('å“åº”æ–‡æœ¬é•¿åº¦:', text.length);
                    
                    let result;
                    try {
                        result = JSON.parse(text);
                    } catch (jsonError) {
                        console.error('JSONè§£æå¤±è´¥:', jsonError);
                        console.error('å“åº”æ–‡æœ¬:', text.substring(0, 1000));
                        alert('é¢„æµ‹å¤±è´¥ï¼šæœåŠ¡å™¨è¿”å›äº†æ— æ•ˆçš„æ•°æ®æ ¼å¼\n\nè¯·æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°(F12)æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯');
                        location.reload();
                        return;
                    }
                    
                    console.log('APIè¿”å›ç»“æœ:', result);
                    
                    if (result.success) {
                        try {
                            displayResults(result.data);
                        } catch (displayError) {
                            console.error('æ˜¾ç¤ºç»“æœå¤±è´¥:', displayError);
                            console.error('é”™è¯¯å †æ ˆ:', displayError.stack);
                            console.error('ç»“æœæ•°æ®:', result.data);
                            alert('é¢„æµ‹ç»“æœæ˜¾ç¤ºå¤±è´¥ï¼š' + displayError.message + '\n\nè¯·æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°(F12)æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯');
                            location.reload();
                        }
                    } else {
                        alert('é¢„æµ‹å¤±è´¥ï¼š' + result.error);
                        location.reload();
                    }
                } catch (error) {
                    console.error('Error:', error);
                    console.error('é”™è¯¯å †æ ˆ:', error.stack);
                    alert('é¢„æµ‹å¤±è´¥ï¼š' + error.message + '\n\nè¯·æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°(F12)æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯');
                    location.reload();
                }
            });
        });

        function displayResults(r) {
            document.getElementById('loading').classList.remove('show');
            document.getElementById('resultsSection').classList.add('show');
            
            // ç»Ÿä¸€ç»“æœæ˜ å°„ï¼ˆå…¼å®¹åç«¯è¿”å›çš„å­—æ®µç»“æ„ï¼‰
            const arch = r.architecture || {};
            const topo = arch.topology || {};
            const cost = (r.cost_breakdown && r.cost_breakdown.summary) ? r.cost_breakdown.summary : {};
            
            // å¤„ç†equipment: åç«¯è¿”å›çš„æ˜¯å­—å…¸å¯¹è±¡ï¼ˆåŒ…å«servers, network_devicesç­‰åˆ†ç±»ï¼‰
            let equipment = r.equipment || {};
            
            // ç¡®ä¿æ‰€æœ‰è®¾å¤‡åˆ—è¡¨éƒ½å­˜åœ¨
            if (!equipment.servers) equipment.servers = [];
            if (!equipment.network_devices) equipment.network_devices = [];
            if (!equipment.storage) equipment.storage = [];
            if (!equipment.infrastructure) equipment.infrastructure = [];
            
            const costBreakdown = (r.cost_breakdown && r.cost_breakdown.breakdown) ? r.cost_breakdown.breakdown : {};
            
            // ä¿¡åˆ›æˆæœ¬å˜é‡ï¼ˆæå‡åˆ°å‡½æ•°ä½œç”¨åŸŸï¼Œä¾›å¤šå¤„ä½¿ç”¨ï¼‰
            let originalCost = 0;
            let xinchuanCost = 0;
            let costSavings = 0;
            let savingsPercent = 0;
            
            const mapped = {
                architecture_type: arch.type || 'unknown',
                node_count: (topo.db_nodes || 0) + (topo.app_nodes || 0) + (topo.proxy_nodes || 0) + (topo.monitor_nodes || 0),
                shard_count: topo.shard_count || 0,
                replica_count: topo.replica_count || 0,
                total_cost: cost.three_year_tco || cost.initial_investment || 0,
                hardware_cost: cost.total_hardware || 0,
                software_cost: cost.total_software || 0,
                ops_cost: cost.annual_operating || 0,
            };
            
            const resultsContent = document.getElementById('resultsContent');
            
            // ç”ŸæˆæœåŠ¡å™¨æ¸…å•HTML
            let serversHTML = '';
            if (equipment.servers && equipment.servers.length > 0) {
                serversHTML = `
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px; border: 1px solid #d0d0d0; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); border-bottom: 3px solid #1a252f;">
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">ç¼–å·</th>
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">è§’è‰²</th>
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å‹å·</th>
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">CPU</th>
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å†…å­˜</th>
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å­˜å‚¨</th>
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">ç½‘ç»œ</th>
                                <th style="padding: 14px 12px; text-align: right; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å•ä»·(Â¥)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${equipment.servers.map((s, index) => `
                                <tr style="border-bottom: 1px solid #e8e8e8; background: ${index % 2 === 0 ? '#ffffff' : '#f9fafb'}; transition: background 0.2s;">
                                    <td style="padding: 12px; color: #2c3e50; font-size: 13px;">${index + 1}</td>
                                    <td style="padding: 12px; color: #2c3e50; font-size: 13px; font-weight: 500;">${s.role || s.category || '-'}</td>
                                    <td style="padding: 12px; color: #34495e; font-size: 13px;">${s.model || s.name || '-'}</td>
                                    <td style="padding: 12px; color: #555; font-size: 13px;">${s.cpu || s.cpu_model || (s.cpu_cores ? s.cpu_cores + 'æ ¸' : '-')}</td>
                                    <td style="padding: 12px; color: #555; font-size: 13px;">${s.memory || (s.memory_gb ? s.memory_gb + 'GB' : '-')}</td>
                                    <td style="padding: 12px; color: #555; font-size: 13px;">${s.disk || (s.disk_gb ? s.disk_gb + 'GB ' + (s.disk_type || '') : '-')}</td>
                                    <td style="padding: 12px; color: #555; font-size: 13px;">${s.network || '-'}</td>
                                    <td style="padding: 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">Â¥${Number(s.unit_price || 0).toLocaleString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                        <tfoot>
                            <tr style="background: linear-gradient(135deg, #ecf0f1 0%, #d5dbdb 100%); border-top: 2px solid #bdc3c7;">
                                <td colspan="7" style="padding: 14px 12px; text-align: right; color: #2c3e50; font-weight: 700; font-size: 14px;">æœåŠ¡å™¨å°è®¡ï¼š</td>
                                <td style="padding: 14px 12px; text-align: right; color: #27ae60; font-weight: 700; font-size: 15px;">Â¥${Number(equipment.servers.reduce((sum, s) => sum + (s.total_price || 0), 0)).toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
            }
            
            // ç”Ÿæˆç½‘ç»œè®¾å¤‡æ¸…å•HTML
            let networkHTML = '';
            if (equipment.network_devices && equipment.network_devices.length > 0) {
                networkHTML = `
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px; border: 1px solid #d0d0d0; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #16a085 0%, #1abc9c 100%); border-bottom: 3px solid #138d75;">
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">ç¼–å·</th>
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">ç±»å‹</th>
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å‹å·</th>
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">è§„æ ¼</th>
                                <th style="padding: 14px 12px; text-align: center; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">æ•°é‡</th>
                                <th style="padding: 14px 12px; text-align: right; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å•ä»·(Â¥)</th>
                                <th style="padding: 14px 12px; text-align: right; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å°è®¡(Â¥)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${equipment.network_devices.map((n, index) => `
                                <tr style="border-bottom: 1px solid #e8e8e8; background: ${index % 2 === 0 ? '#ffffff' : '#f9fafb'};">
                                    <td style="padding: 12px; color: #2c3e50; font-size: 13px;">${index + 1}</td>
                                    <td style="padding: 12px; color: #2c3e50; font-size: 13px; font-weight: 500;">${n.type || n.category || '-'}</td>
                                    <td style="padding: 12px; color: #34495e; font-size: 13px;">${n.model || n.name || '-'}</td>
                                    <td style="padding: 12px; color: #555; font-size: 13px;">${n.ports || n.spec || n.throughput || '-'}</td>
                                    <td style="padding: 12px; text-align: center; color: #555; font-size: 13px; font-weight: 600;">${n.quantity || 1}</td>
                                    <td style="padding: 12px; text-align: right; color: #555; font-size: 13px;">Â¥${Number(n.unit_price || 0).toLocaleString()}</td>
                                    <td style="padding: 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">Â¥${Number(n.total_price || 0).toLocaleString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                        <tfoot>
                            <tr style="background: linear-gradient(135deg, #d5f4e6 0%, #c8e6c9 100%); border-top: 2px solid #a5d6a7;">
                                <td colspan="6" style="padding: 14px 12px; text-align: right; color: #2c3e50; font-weight: 700; font-size: 14px;">ç½‘ç»œè®¾å¤‡å°è®¡ï¼š</td>
                                <td style="padding: 14px 12px; text-align: right; color: #27ae60; font-weight: 700; font-size: 15px;">Â¥${Number(equipment.network_devices.reduce((sum, n) => sum + (n.total_price || 0), 0)).toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
            }
            
            // ç”Ÿæˆå­˜å‚¨è®¾å¤‡æ¸…å•HTML
            let storageHTML = '';
            if (equipment.storage && equipment.storage.length > 0) {
                storageHTML = `
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px; border: 1px solid #d0d0d0; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #8e44ad 0%, #9b59b6 100%); border-bottom: 3px solid #7d3c98;">
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">ç±»å‹</th>
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å‹å·</th>
                                <th style="padding: 14px 12px; text-align: center; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å®¹é‡(TB)</th>
                                <th style="padding: 14px 12px; text-align: center; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">IOPS</th>
                                <th style="padding: 14px 12px; text-align: center; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">ååé‡</th>
                                <th style="padding: 14px 12px; text-align: right; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å•ä»·/TB(Â¥)</th>
                                <th style="padding: 14px 12px; text-align: right; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å°è®¡(Â¥)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${equipment.storage.map((s, index) => `
                                <tr style="border-bottom: 1px solid #e8e8e8; background: ${index % 2 === 0 ? '#ffffff' : '#f9fafb'};">
                                    <td style="padding: 12px; color: #2c3e50; font-size: 13px; font-weight: 500;">${s.type}</td>
                                    <td style="padding: 12px; color: #34495e; font-size: 13px;">${s.model}</td>
                                    <td style="padding: 12px; text-align: center; color: #555; font-size: 13px; font-weight: 600;">${s.capacity_tb}</td>
                                    <td style="padding: 12px; text-align: center; color: #555; font-size: 13px;">${Number(s.iops).toLocaleString()}</td>
                                    <td style="padding: 12px; text-align: center; color: #555; font-size: 13px;">${s.throughput}</td>
                                    <td style="padding: 12px; text-align: right; color: #555; font-size: 13px;">${Number(s.unit_price_per_tb).toLocaleString()}</td>
                                    <td style="padding: 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(s.total_price).toLocaleString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                        <tfoot>
                            <tr style="background: linear-gradient(135deg, #e8daef 0%, #d7bde2 100%); border-top: 2px solid #c39bd3;">
                                <td colspan="6" style="padding: 14px 12px; text-align: right; color: #2c3e50; font-weight: 700; font-size: 14px;">å­˜å‚¨è®¾å¤‡å°è®¡ï¼š</td>
                                <td style="padding: 14px 12px; text-align: right; color: #27ae60; font-weight: 700; font-size: 15px;">Â¥${Number(equipment.storage.reduce((sum, s) => sum + (s.total_price || 0), 0)).toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
            }
            
            // ç”ŸæˆåŸºç¡€è®¾æ–½æ¸…å•HTML
            let infraHTML = '';
            if (equipment.infrastructure && equipment.infrastructure.length > 0) {
                infraHTML = `
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px; border: 1px solid #d0d0d0; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #d35400 0%, #e67e22 100%); border-bottom: 3px solid #ba4a00;">
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">ç±»å‹</th>
                                <th style="padding: 14px 12px; text-align: center; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">æ•°é‡/å®¹é‡</th>
                                <th style="padding: 14px 12px; text-align: right; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å•ä»·(Â¥)</th>
                                <th style="padding: 14px 12px; text-align: right; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">å°è®¡(Â¥)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${equipment.infrastructure.map((i, index) => `
                                <tr style="border-bottom: 1px solid #e8e8e8; background: ${index % 2 === 0 ? '#ffffff' : '#f9fafb'};">
                                    <td style="padding: 12px; color: #2c3e50; font-size: 13px; font-weight: 500;">${i.type}</td>
                                    <td style="padding: 12px; text-align: center; color: #555; font-size: 13px; font-weight: 600;">${i.quantity || i.capacity_kw || '-'}</td>
                                    <td style="padding: 12px; text-align: right; color: #555; font-size: 13px;">${Number(i.unit_price).toLocaleString()}</td>
                                    <td style="padding: 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(i.total_price).toLocaleString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                        <tfoot>
                            <tr style="background: linear-gradient(135deg, #fdebd0 0%, #f8c471 100%); border-top: 2px solid #f5b041;">
                                <td colspan="3" style="padding: 14px 12px; text-align: right; color: #2c3e50; font-weight: 700; font-size: 14px;">åŸºç¡€è®¾æ–½å°è®¡ï¼š</td>
                                <td style="padding: 14px 12px; text-align: right; color: #27ae60; font-weight: 700; font-size: 15px;">Â¥${Number(equipment.infrastructure.reduce((sum, i) => sum + i.total_price, 0)).toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
            }
            
            // ç”Ÿæˆè¯¦ç»†æŠ¥ä»·å•HTML
            let quotationHTML = '';
            if (costBreakdown.hardware || costBreakdown.software || costBreakdown.services) {
                quotationHTML = `
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px; border: 1px solid #d0d0d0; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #2980b9 0%, #3498db 100%); color: white; border-bottom: 3px solid #1f618d;">
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">ç±»åˆ«</th>
                                <th style="padding: 14px 12px; text-align: left; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">é¡¹ç›®</th>
                                <th style="padding: 14px 12px; text-align: right; color: #ffffff; font-weight: 600; font-size: 13px; letter-spacing: 0.5px;">é‡‘é¢(Â¥)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${costBreakdown.hardware ? `
                                <tr style="background: linear-gradient(135deg, #ecf0f1 0%, #d5dbdb 100%); font-weight: bold; border-bottom: 2px solid #bdc3c7;">
                                    <td colspan="3" style="padding: 12px; color: #2c3e50; font-size: 14px; font-weight: 700;">ğŸ’» ç¡¬ä»¶æˆæœ¬</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e8e8e8; background: #ffffff;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">æœåŠ¡å™¨</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(costBreakdown.hardware.servers || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e8e8e8; background: #f9fafb;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">ç½‘ç»œè®¾å¤‡</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(costBreakdown.hardware.network_devices || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e8e8e8; background: #ffffff;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">å­˜å‚¨è®¾å¤‡</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(costBreakdown.hardware.storage || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 2px solid #bdc3c7; background: #f9fafb;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">åŸºç¡€è®¾æ–½</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(costBreakdown.hardware.infrastructure || 0).toLocaleString()}</td>
                                </tr>
                            ` : ''}
                            ${costBreakdown.software ? `
                                <tr style="background: linear-gradient(135deg, #d5f4e6 0%, #c8e6c9 100%); font-weight: bold; border-bottom: 2px solid #a5d6a7;">
                                    <td colspan="3" style="padding: 12px; color: #2c3e50; font-size: 14px; font-weight: 700;">ğŸ“¦ è½¯ä»¶è®¸å¯è¯</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e8e8e8; background: #ffffff;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">TDSQLä¼ä¸šç‰ˆè®¸å¯è¯</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(costBreakdown.software.tdsql_license || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e8e8e8; background: #f9fafb;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">æ“ä½œç³»ç»Ÿè®¸å¯è¯</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(costBreakdown.software.os_license || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e8e8e8; background: #ffffff;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">ç›‘æ§è½¯ä»¶</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(costBreakdown.software.monitoring || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 2px solid #a5d6a7; background: #f9fafb;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">å¤‡ä»½è½¯ä»¶</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(costBreakdown.software.backup || 0).toLocaleString()}</td>
                                </tr>
                            ` : ''}
                            ${costBreakdown.services ? `
                                <tr style="background: linear-gradient(135deg, #e8daef 0%, #d7bde2 100%); font-weight: bold; border-bottom: 2px solid #c39bd3;">
                                    <td colspan="3" style="padding: 12px; color: #2c3e50; font-size: 14px; font-weight: 700;">ğŸ› ï¸ å®æ–½æœåŠ¡</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e8e8e8; background: #ffffff;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">éƒ¨ç½²å®æ–½è´¹ç”¨</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(costBreakdown.services.deployment || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 2px solid #c39bd3; background: #f9fafb;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">æŠ€æœ¯åŸ¹è®­</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #27ae60; font-weight: 600; font-size: 13px;">${Number(costBreakdown.services.training || 0).toLocaleString()}</td>
                                </tr>
                            ` : ''}
                            ${costBreakdown.annual_operating ? `
                                <tr style="background: linear-gradient(135deg, #fdebd0 0%, #f8c471 100%); font-weight: bold; border-bottom: 2px solid #f5b041;">
                                    <td colspan="3" style="padding: 12px; color: #2c3e50; font-size: 14px; font-weight: 700;">ğŸ“Š å¹´åº¦è¿è¥æˆæœ¬</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e8e8e8; background: #ffffff;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">ç”µåŠ›æˆæœ¬</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #e67e22; font-weight: 600; font-size: 13px;">${Number(costBreakdown.annual_operating.power || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e8e8e8; background: #f9fafb;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">åˆ¶å†·æˆæœ¬</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #e67e22; font-weight: 600; font-size: 13px;">${Number(costBreakdown.annual_operating.cooling || 0).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 2px solid #f5b041; background: #ffffff;">
                                    <td style="padding: 10px 12px; padding-left: 35px;"></td>
                                    <td style="padding: 10px 12px; color: #34495e; font-size: 13px;">ç»´æŠ¤æˆæœ¬</td>
                                    <td style="padding: 10px 12px; text-align: right; color: #e67e22; font-weight: 600; font-size: 13px;">${Number(costBreakdown.annual_operating.maintenance || 0).toLocaleString()}</td>
                                </tr>
                            ` : ''}
                        </tbody>
                        <tfoot>
                            <tr style="background: linear-gradient(135deg, #2980b9 0%, #3498db 100%); color: white; font-weight: bold; font-size: 16px; border-top: 3px solid #1f618d;">
                                <td colspan="2" style="padding: 16px 12px; text-align: right; color: #ffffff; font-weight: 700; letter-spacing: 0.5px;">ğŸ’° åˆå§‹æŠ•èµ„æ€»é¢ï¼š</td>
                                <td style="padding: 16px 12px; text-align: right; color: #ffffff; font-weight: 700; font-size: 17px;">Â¥${Number(cost.initial_investment || 0).toLocaleString()}</td>
                            </tr>
                            <tr style="background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%); color: white; font-weight: bold; font-size: 16px;">
                                <td colspan="2" style="padding: 16px 12px; text-align: right; color: #ffffff; font-weight: 700; letter-spacing: 0.5px;">ğŸ“ˆ ä¸‰å¹´TCOæ€»æˆæœ¬ï¼š</td>
                                <td style="padding: 16px 12px; text-align: right; color: #ffffff; font-weight: 700; font-size: 17px;">Â¥${Number(cost.three_year_tco || 0).toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
            }
            
            // ç”Ÿæˆä¿¡åˆ›å¯¹æ¯”å¡ç‰‡HTML
            let xinchuanComparisonHTML = '';
            if (r.xinchuan_enabled && r.xinchuan_solution && r.traditional_solution) {
                const xcSolution = r.xinchuan_solution;
                const traditionalSolution = r.traditional_solution;
                const xcInfo = r.xinchuan_info || {};
                const xcCost = xcSolution.cost_breakdown || {};
                const traditionalCost = traditionalSolution.cost_breakdown || {};
                
                // ä½¿ç”¨çœŸå®çš„æˆæœ¬å¯¹æ¯”æ•°æ®ï¼ˆèµ‹å€¼ç»™å‡½æ•°ä½œç”¨åŸŸçš„å˜é‡ï¼‰
                const costComparison = r.cost_comparison || {};
                originalCost = costComparison.traditional_cost || traditionalCost.total_initial_cost || 0;
                xinchuanCost = costComparison.xinchuan_cost || xcCost.total_initial_cost || 0;
                costSavings = costComparison.cost_savings || (originalCost - xinchuanCost);
                savingsPercent = costComparison.savings_percent || (originalCost > 0 ? ((costSavings / originalCost) * 100).toFixed(1) : 0);
                
                xinchuanComparisonHTML = `
                    <div class="result-card" style="background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%); border: 3px solid #667eea;">
                        <h3 style="color: #667eea;">ğŸ‡¨ğŸ‡³ ä¿¡åˆ›å›½äº§åŒ–æ–¹æ¡ˆå¯¹æ¯”</h3>
                        
                        <!-- æ¶æ„å¯¹æ¯”è¯´æ˜ -->
                        <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 12px 15px; margin: 15px 0; border-radius: 6px;">
                            <div style="font-weight: 600; color: #856404; margin-bottom: 5px;">ğŸ“‹ æ¶æ„è¯´æ˜</div>
                            <div style="font-size: 13px; color: #856404; line-height: 1.6;">
                                ä¼ ç»Ÿæ–¹æ¡ˆå’Œä¿¡åˆ›æ–¹æ¡ˆé‡‡ç”¨<strong>ç‹¬ç«‹æ¶æ„è®¾è®¡</strong>ï¼Œæ ¹æ®å„è‡ªè®¾å¤‡æ€§èƒ½ä¼˜åŒ–é…ç½®ã€‚
                                è®¾å¤‡æ•°é‡ã€è§„æ ¼å¯èƒ½ä¸åŒï¼Œä»·æ ¼å¯¹æ¯”åŸºäºå„è‡ªå®Œæ•´æ¶æ„çš„æ€»æˆæœ¬ã€‚
                            </div>
                        </div>
                        
                        <!-- æ¶æ„å·®å¼‚å¯¹æ¯” -->
                        <div style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border-radius: 12px; padding: 25px; margin: 20px 0; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; font-size: 18px; font-weight: 700; display: flex; align-items: center; gap: 10px;">
                                <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; width: 32px; height: 32px; border-radius: 8px; display: inline-flex; align-items: center; justify-content: center; font-size: 16px;">ğŸ—ï¸</span>
                                æ¶æ„é…ç½®å¯¹æ¯”
                            </h4>
                            <table style="width: 100%; border-collapse: separate; border-spacing: 0; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); border-radius: 8px; overflow: hidden;">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                        <th style="padding: 15px; text-align: left; color: white; font-weight: 600; font-size: 14px; border: none;">é…ç½®é¡¹</th>
                                        <th style="padding: 15px; text-align: center; color: white; font-weight: 600; font-size: 14px; border: none;">ä¼ ç»Ÿæ–¹æ¡ˆ</th>
                                        <th style="padding: 15px; text-align: center; color: white; font-weight: 600; font-size: 14px; border: none;">ä¿¡åˆ›æ–¹æ¡ˆ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr style="background: white;">
                                        <td style="padding: 12px 15px; border-bottom: 1px solid #e9ecef; font-weight: 600; color: #495057;">æ•°æ®åº“èŠ‚ç‚¹</td>
                                        <td style="padding: 12px 15px; text-align: center; border-bottom: 1px solid #e9ecef; color: #6c757d;">${traditionalSolution.architecture?.database_nodes || 0}å°</td>
                                        <td style="padding: 12px 15px; text-align: center; border-bottom: 1px solid #e9ecef; color: #6c757d;">${xcSolution.architecture?.database_nodes || 0}å°</td>
                                    </tr>
                                    <tr style="background: #f8f9fa;">
                                        <td style="padding: 12px 15px; border-bottom: 1px solid #e9ecef; font-weight: 600; color: #495057;">ä»£ç†èŠ‚ç‚¹</td>
                                        <td style="padding: 12px 15px; text-align: center; border-bottom: 1px solid #e9ecef; color: #6c757d;">${traditionalSolution.architecture?.proxy_nodes || 0}å°</td>
                                        <td style="padding: 12px 15px; text-align: center; border-bottom: 1px solid #e9ecef; color: #6c757d;">${xcSolution.architecture?.proxy_nodes || 0}å°</td>
                                    </tr>
                                    <tr style="background: white;">
                                        <td style="padding: 12px 15px; border-bottom: 1px solid #e9ecef; font-weight: 600; color: #495057;">ç›‘æ§èŠ‚ç‚¹</td>
                                        <td style="padding: 12px 15px; text-align: center; border-bottom: 1px solid #e9ecef; color: #6c757d;">${traditionalSolution.architecture?.monitoring_nodes || 0}å°</td>
                                        <td style="padding: 12px 15px; text-align: center; border-bottom: 1px solid #e9ecef; color: #6c757d;">${xcSolution.architecture?.monitoring_nodes || 0}å°</td>
                                    </tr>
                                    <tr style="background: #f8f9fa;">
                                        <td style="padding: 12px 15px; border-bottom: none; font-weight: 600; color: #495057;">èŠ‚ç‚¹è§„æ ¼</td>
                                        <td style="padding: 12px 15px; text-align: center; border-bottom: none; font-size: 13px; color: #6c757d;">${traditionalSolution.architecture?.node_spec || 'N/A'}</td>
                                        <td style="padding: 12px 15px; text-align: center; border-bottom: none; font-size: 13px; color: #6c757d;">${xcSolution.architecture?.node_spec || 'N/A'}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border-radius: 12px; padding: 25px; margin: 20px 0; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                            <div style="display: flex; justify-content: space-between; gap: 15px; margin-bottom: 20px;">
                                <div style="flex: 1; text-align: center; padding: 20px; background: linear-gradient(135deg, #fff5f5 0%, #ffe5e5 100%); border-radius: 10px; border: 2px solid #dc3545; box-shadow: 0 2px 8px rgba(220,53,69,0.1);">
                                    <div style="font-size: 14px; color: #721c24; margin-bottom: 10px; font-weight: 600;">ä¼ ç»Ÿæ–¹æ¡ˆï¼ˆå›½å¤–å“ç‰Œï¼‰</div>
                                    <div style="font-size: 28px; font-weight: bold; color: #dc3545; margin: 10px 0;">Â¥${Number(originalCost).toLocaleString()}</div>
                                    <div style="font-size: 12px; color: #6c757d; margin-top: 8px; padding: 5px 10px; background: rgba(255,255,255,0.7); border-radius: 4px; display: inline-block;">Dellã€Ciscoç­‰</div>
                                </div>
                                <div style="flex: 1; text-align: center; padding: 20px; background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); border-radius: 10px; border: 2px solid #28a745; box-shadow: 0 2px 8px rgba(40,167,69,0.15);">
                                    <div style="font-size: 14px; color: #155724; margin-bottom: 10px; font-weight: 600;">ä¿¡åˆ›æ–¹æ¡ˆï¼ˆ${r.xinchuan_mode === 'standard' ? 'æ ‡å‡†ä¿¡åˆ›' : r.xinchuan_mode === 'strict' ? 'ä¸¥æ ¼ä¿¡åˆ›' : 'å®Œå…¨ä¿¡åˆ›'}ï¼‰</div>
                                    <div style="font-size: 28px; font-weight: bold; color: #28a745; margin: 10px 0;">Â¥${Number(xinchuanCost).toLocaleString()}</div>
                                    <div style="font-size: 12px; color: #155724; margin-top: 8px; padding: 5px 10px; background: rgba(255,255,255,0.7); border-radius: 4px; display: inline-block;">${xcInfo.servers ? xcInfo.servers.join('ã€') : 'æµªæ½®ã€åä¸º'}</div>
                                </div>
                            </div>
                            ${costSavings > 0 ? `
                                <div style="text-align: center; padding: 18px; background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%); border-radius: 10px; border: 2px solid #ffc107; box-shadow: 0 2px 8px rgba(255,193,7,0.15);">
                                    <div style="font-size: 20px; font-weight: bold; color: #856404;">
                                        ğŸ’° æˆæœ¬èŠ‚çº¦ï¼šÂ¥${Number(costSavings).toLocaleString()} 
                                        <span style="color: #28a745; margin-left: 10px;">(èŠ‚çº¦ ${savingsPercent}%)</span>
                                    </div>
                                    <div style="font-size: 13px; color: #856404; margin-top: 10px;">ä½¿ç”¨å›½äº§åŒ–è®¾å¤‡ï¼Œäº«å—æˆæœ¬ä¼˜åŠ¿å’Œæ”¿ç­–æ”¯æŒ</div>
                                </div>
                            ` : ''}
                        </div>
                        ${xcInfo.mode ? `
                            <div style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border-radius: 12px; padding: 20px; margin-top: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                                <div style="font-weight: 700; margin-bottom: 15px; color: #2c3e50; font-size: 16px; display: flex; align-items: center; gap: 8px;">
                                    <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; width: 28px; height: 28px; border-radius: 6px; display: inline-flex; align-items: center; justify-content: center; font-size: 14px;">ğŸ“‹</span>
                                    ä¿¡åˆ›æ–¹æ¡ˆè¯¦æƒ…
                                </div>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                                    <div style="padding: 12px; background: white; border-radius: 8px; border: 1px solid #e9ecef; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
                                        <div style="font-size: 12px; color: #6c757d; margin-bottom: 6px;">æœåŠ¡å™¨å“ç‰Œ</div>
                                        <div style="font-size: 15px; font-weight: 600; color: #495057;">${xcInfo.servers ? xcInfo.servers.join('ã€') : '-'}</div>
                                    </div>
                                    <div style="padding: 12px; background: white; border-radius: 8px; border: 1px solid #e9ecef; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
                                        <div style="font-size: 12px; color: #6c757d; margin-bottom: 6px;">ç½‘ç»œè®¾å¤‡</div>
                                        <div style="font-size: 15px; font-weight: 600; color: #495057;">${xcInfo.network ? xcInfo.network.join('ã€') : '-'}</div>
                                    </div>
                                    <div style="padding: 12px; background: white; border-radius: 8px; border: 1px solid #e9ecef; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
                                        <div style="font-size: 12px; color: #6c757d; margin-bottom: 6px;">CPUèŠ¯ç‰‡</div>
                                        <div style="font-size: 15px; font-weight: 600; color: #495057;">${xcInfo.cpu ? xcInfo.cpu.join('ã€') : '-'}</div>
                                    </div>
                                    <div style="padding: 12px; background: white; border-radius: 8px; border: 1px solid #e9ecef; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
                                        <div style="font-size: 12px; color: #6c757d; margin-bottom: 6px;">åˆè§„æ€§</div>
                                        <div style="font-size: 15px; font-weight: 600; color: #28a745;">${xcInfo.compliance || 'ç¬¦åˆä¿¡åˆ›è¦æ±‚'}</div>
                                    </div>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
            }

            // ç”Ÿæˆä¿¡åˆ›è®¾å¤‡æ¸…å•å¯¹æ¯”HTML
            let xinchuanEquipmentHTML = '';
            if (r.xinchuan_enabled && r.xinchuan_solution && r.traditional_solution) {
                const xcSolution = r.xinchuan_solution;
                const traditionalSolution = r.traditional_solution;
                const xcEquipment = xcSolution.equipment_list || [];
                const traditionalEquipment = traditionalSolution.equipment_list || [];
                
                // ç¡®ä¿æˆæœ¬å˜é‡å·²åˆå§‹åŒ–ï¼ˆç§»åˆ°è¿™é‡Œï¼Œåœ¨ä½¿ç”¨å‰å°±è®¡ç®—å¥½ï¼‰
                const costComparison = r.cost_comparison || {};
                const xcCost = xcSolution.cost_breakdown || {};
                const traditionalCost = traditionalSolution.cost_breakdown || {};
                
                // æ— è®ºä¹‹å‰æ˜¯å¦èµ‹å€¼ï¼Œéƒ½åœ¨è¿™é‡Œé‡æ–°èµ‹å€¼ä»¥ç¡®ä¿åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­å¯ç”¨
                originalCost = costComparison.traditional_cost || traditionalCost.total_initial_cost || 0;
                xinchuanCost = costComparison.xinchuan_cost || xcCost.total_initial_cost || 0;
                costSavings = costComparison.cost_savings || (originalCost - xinchuanCost);
                savingsPercent = costComparison.savings_percent || (originalCost > 0 ? ((costSavings / originalCost) * 100).toFixed(1) : 0);
                
                xinchuanEquipmentHTML = `
                    <div class="result-card" style="background: linear-gradient(135deg, #f0f9ff 0%, #f5f3ff 100%); border: 2px solid #667eea; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                        <h3 style="color: #2c3e50; font-size: 20px; font-weight: 700; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; width: 36px; height: 36px; border-radius: 8px; display: inline-flex; align-items: center; justify-content: center; font-size: 18px;">ğŸ“‹</span>
                            è®¾å¤‡æ¸…å•å¯¹æ¯”ï¼ˆä¼ ç»Ÿæ–¹æ¡ˆ vs ä¿¡åˆ›æ–¹æ¡ˆï¼‰
                        </h3>
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: separate; border-spacing: 0; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                        <th style="padding: 15px; text-align: left; color: white; font-weight: 600; font-size: 14px; border: none;">è®¾å¤‡ç±»å‹</th>
                                        <th style="padding: 15px; text-align: left; color: white; font-weight: 600; font-size: 14px; border: none;">ä¼ ç»Ÿæ–¹æ¡ˆï¼ˆå›½å¤–å“ç‰Œï¼‰</th>
                                        <th style="padding: 15px; text-align: left; color: white; font-weight: 600; font-size: 14px; border: none;">ä¿¡åˆ›æ–¹æ¡ˆï¼ˆå›½äº§å“ç‰Œï¼‰</th>
                                        <th style="padding: 15px; text-align: center; color: white; font-weight: 600; font-size: 14px; border: none;">æ•°é‡</th>
                                        <th style="padding: 15px; text-align: right; color: white; font-weight: 600; font-size: 14px; border: none;">ä¼ ç»Ÿå•ä»·</th>
                                        <th style="padding: 15px; text-align: right; color: white; font-weight: 600; font-size: 14px; border: none;">ä¿¡åˆ›å•ä»·</th>
                                        <th style="padding: 15px; text-align: right; color: white; font-weight: 600; font-size: 14px; border: none;">æˆæœ¬å·®å¼‚</th>
                                    </tr>
                                </thead>
                                <tbody>
                `;
                
                // åˆ›å»ºè®¾å¤‡æ˜ å°„è¡¨,æŒ‰ç±»åˆ«åŒ¹é…ä¼ ç»Ÿæ–¹æ¡ˆå’Œä¿¡åˆ›æ–¹æ¡ˆ
                const equipmentMap = new Map();
                
                // å°†ä¿¡åˆ›æ–¹æ¡ˆè®¾å¤‡æŒ‰ç±»åˆ«åˆ†ç»„ï¼ˆåªæŒ‰ç±»åˆ«ï¼Œä¸æŒ‰æ•°é‡ï¼‰
                xcEquipment.forEach(item => {
                    const key = item.category;
                    if (!equipmentMap.has(key)) {
                        equipmentMap.set(key, { xc: [], traditional: [] });
                    }
                    equipmentMap.get(key).xc.push(item);
                });
                
                // å°†ä¼ ç»Ÿæ–¹æ¡ˆè®¾å¤‡æŒ‰ç±»åˆ«åˆ†ç»„ï¼ˆåªæŒ‰ç±»åˆ«ï¼Œä¸æŒ‰æ•°é‡ï¼‰
                traditionalEquipment.forEach(item => {
                    const key = item.category;
                    if (!equipmentMap.has(key)) {
                        equipmentMap.set(key, { xc: [], traditional: [] });
                    }
                    equipmentMap.get(key).traditional.push(item);
                });
                
                // æŒ‰ç±»åˆ«é¡ºåºæ’åº
                const categoryOrder = ['æ•°æ®åº“æœåŠ¡å™¨', 'ä»£ç†æœåŠ¡å™¨', 'ç›‘æ§æœåŠ¡å™¨', 'æ ¸å¿ƒäº¤æ¢æœº', 'æ¥å…¥äº¤æ¢æœº', 'å®‰å…¨é˜²ç«å¢™', 'å­˜å‚¨è®¾å¤‡'];
                const sortedEntries = Array.from(equipmentMap.entries()).sort((a, b) => {
                    const catA = a[0];
                    const catB = b[0];
                    const indexA = categoryOrder.indexOf(catA);
                    const indexB = categoryOrder.indexOf(catB);
                    return (indexA === -1 ? 999 : indexA) - (indexB === -1 ? 999 : indexB);
                });
                
                // ç”Ÿæˆå¯¹æ¯”è¡Œ
                sortedEntries.forEach(([category, items]) => {
                    const xcItems = items.xc;
                    const tradItems = items.traditional;
                    
                    if (xcItems.length === 0 && tradItems.length === 0) return;
                    
                    // ç¡®ä¿è‡³å°‘æœ‰ä¸€é¡¹
                    const maxItems = Math.max(xcItems.length, tradItems.length, 1);
                    
                    for (let i = 0; i < maxItems; i++) {
                        const xcItem = xcItems[i] || {};
                        const tradItem = tradItems[i] || {};
                        
                        // å¦‚æœä¼ ç»Ÿæ–¹æ¡ˆæ²¡æœ‰å¯¹åº”è®¾å¤‡ï¼Œä½¿ç”¨ä¿¡åˆ›è®¾å¤‡ä¼°ç®—
                        const traditionalName = tradItem.name || (xcItem.name ? xcItem.name.replace(/æµªæ½®|åä¸º|è”æƒ³|å¤©èä¿¡|å¯æ˜æ˜Ÿè¾°|é”æ·|æ–°åä¸‰/g, 'Dell/Cisco') : '-');
                        const traditionalSpec = tradItem.spec || xcItem.spec || '-';
                        const traditionalPrice = tradItem.unit_price || 0;
                        const traditionalQuantity = tradItem.quantity || xcItem.quantity || 1;
                        const traditionalVendor = tradItem.vendor || 'Dell/Cisco';
                        
                        const xcName = xcItem.name || '-';
                        const xcSpec = xcItem.spec || '-';
                        const xcPrice = xcItem.unit_price || 0;
                        const xcQuantity = xcItem.quantity || traditionalQuantity;
                        const xcVendor = xcItem.vendor || '-';
                        const xcCert = xcItem.certification || '-';
                        
                        const priceDiff = traditionalPrice - xcPrice;
                        const itemSavingsPercent = traditionalPrice > 0 ? ((priceDiff / traditionalPrice) * 100).toFixed(1) : 0;
                        
                        xinchuanEquipmentHTML += `
                            <tr style="border-bottom: 1px solid #eee; ${i === 0 ? 'border-top: 2px solid #667eea;' : ''}">
                                ${i === 0 ? `<td rowspan="${maxItems}" style="padding: 12px; font-weight: 600; color: #667eea; border: 1px solid #ddd; vertical-align: middle; background: #f8f9fa;">${category}</td>` : ''}
                                <td style="padding: 12px; border: 1px solid #ddd;">
                                    <div style="font-weight: 600; color: #dc3545; margin-bottom: 5px;">${traditionalName}</div>
                                    <div style="font-size: 12px; color: #999; line-height: 1.5;">${traditionalSpec}</div>
                                    <div style="font-size: 11px; color: #999; margin-top: 3px;">å‚å•†: ${traditionalVendor}</div>
                                </td>
                                <td style="padding: 12px; border: 1px solid #ddd;">
                                    <div style="font-weight: 600; color: #28a745; margin-bottom: 5px;">${xcName}</div>
                                    <div style="font-size: 12px; color: #666; line-height: 1.5;">${xcSpec}</div>
                                    <div style="font-size: 11px; color: #999; margin-top: 3px;">å‚å•†: ${xcVendor}</div>
                                    ${xcCert !== '-' ? `<div style="font-size: 11px; color: #667eea; margin-top: 2px;">ğŸ… ${xcCert}</div>` : ''}
                                </td>
                                <td style="padding: 12px; text-align: center; font-weight: 600; border: 1px solid #ddd;">${xcQuantity}</td>
                                <td style="padding: 12px; text-align: right; color: #dc3545; border: 1px solid #ddd;">Â¥${traditionalPrice.toLocaleString()}</td>
                                <td style="padding: 12px; text-align: right; color: #28a745; font-weight: 600; border: 1px solid #ddd;">Â¥${xcPrice.toLocaleString()}</td>
                                <td style="padding: 12px; text-align: right; border: 1px solid #ddd;">
                                    <div style="color: #28a745; font-weight: 600;">-Â¥${priceDiff.toLocaleString()}</div>
                                    <div style="font-size: 11px; color: #666;">(çœ${itemSavingsPercent}%)</div>
                                </td>
                            </tr>
                        `;
                    }
                });
                
                xinchuanEquipmentHTML += `
                                </tbody>
                                <tfoot>
                                    <tr style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; font-weight: bold;">
                                        <td colspan="4" style="padding: 16px; text-align: right; border: 1px solid #ddd;">ğŸ’° æ€»æˆæœ¬å¯¹æ¯”ï¼š</td>
                                        <td style="padding: 16px; text-align: right; font-size: 16px; border: 1px solid #ddd;">Â¥${Number(originalCost).toLocaleString()}</td>
                                        <td style="padding: 16px; text-align: right; font-size: 16px; border: 1px solid #ddd;">Â¥${Number(xinchuanCost).toLocaleString()}</td>
                                        <td style="padding: 16px; text-align: right; font-size: 16px; border: 1px solid #ddd;">-Â¥${Number(costSavings).toLocaleString()}</td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                        
                        <!-- è¯¦ç»†è®¾å¤‡é…ç½®æ¸…å• -->
                        <div style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; font-size: 18px; font-weight: 700; display: flex; align-items: center; gap: 10px; border-bottom: 3px solid #667eea; padding-bottom: 12px;">
                                <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; width: 32px; height: 32px; border-radius: 8px; display: inline-flex; align-items: center; justify-content: center; font-size: 16px;">ğŸ“¦</span>
                                ä¿¡åˆ›è®¾å¤‡è¯¦ç»†é…ç½®æ¸…å•
                            </h4>
                            
                            <!-- æœåŠ¡å™¨é…ç½®æ¸…å• -->
                            <div style="margin-bottom: 25px;">
                                <h5 style="color: #495057; margin-bottom: 15px; font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                    <span style="background: #667eea; color: white; width: 28px; height: 28px; border-radius: 6px; display: inline-flex; align-items: center; justify-content: center; font-size: 14px;">ğŸ–¥ï¸</span>
                                    æœåŠ¡å™¨é…ç½®æ¸…å•
                                </h5>
                                <table style="width: 100%; border-collapse: separate; border-spacing: 0; background: white; font-size: 13px; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                    <thead>
                                        <tr style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                            <th style="padding: 12px; text-align: left; color: white; font-weight: 600; border: none;">è®¾å¤‡åç§°</th>
                                            <th style="padding: 12px; text-align: left; color: white; font-weight: 600; border: none;">CPUé…ç½®</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">å†…å­˜</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">ç¡¬ç›˜</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">ç½‘ç»œ</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">åŠŸè€—</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">æ•°é‡</th>
                                            <th style="padding: 12px; text-align: right; color: white; font-weight: 600; border: none;">å•ä»·</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${xcEquipment.filter(item => ['æ•°æ®åº“æœåŠ¡å™¨', 'ä»£ç†æœåŠ¡å™¨', 'ç›‘æ§æœåŠ¡å™¨'].includes(item.category)).map((item, idx) => `
                                            <tr style="border-bottom: 1px solid #dee2e6; ${idx % 2 === 0 ? 'background: #f8f9fa;' : ''}">
                                                <td style="padding: 10px; border: 1px solid #dee2e6;">
                                                    <div style="font-weight: 600; color: #333;">${item.name}</div>
                                                    <div style="font-size: 11px; color: #6c757d;">${item.vendor || '-'} | ${item.use_case || '-'}</div>
                                                </td>
                                                <td style="padding: 10px; border: 1px solid #dee2e6;">
                                                    <div style="color: #495057;">${item.cpu_model || '-'}</div>
                                                    <div style="font-size: 11px; color: #6c757d;">${item.cpu_cores || '-'}æ ¸å¿ƒ</div>
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6; font-weight: 600; color: #495057;">
                                                    ${item.memory_gb || '-'}GB
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6;">
                                                    <div style="font-weight: 600; color: #495057;">${item.disk_gb || '-'}GB</div>
                                                    <div style="font-size: 11px; color: #6c757d;">${item.disk_type || '-'}</div>
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6; font-size: 12px; color: #495057;">
                                                    ${item.network || '-'}
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6; color: #6c757d;">
                                                    ${item.power_w || '-'}W
                                                </td>
                                                <td style="padding: 10px; text-align: center; font-weight: 600; border: 1px solid #dee2e6; color: #495057;">
                                                    ${item.quantity}
                                                </td>
                                                <td style="padding: 10px; text-align: right; font-weight: 600; color: #28a745; border: 1px solid #dee2e6;">
                                                    Â¥${item.unit_price.toLocaleString()}
                                                </td>
                                            </tr>
                                        `).join('')}
                                        ${xcEquipment.filter(item => ['æ ¸å¿ƒäº¤æ¢æœº', 'æ¥å…¥äº¤æ¢æœº', 'å®‰å…¨é˜²ç«å¢™'].includes(item.category)).length === 0 ? `
                                            <tr>
                                                <td colspan="7" style="padding: 20px; text-align: center; color: #999;">æš‚æ— ç½‘ç»œè®¾å¤‡æ•°æ®</td>
                                            </tr>
                                        ` : ''}
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- å­˜å‚¨è®¾å¤‡é…ç½®æ¸…å•ï¼ˆå¦‚æœæœ‰ï¼‰ -->
                            ${xcEquipment.filter(item => item.category === 'å­˜å‚¨è®¾å¤‡').length > 0 ? `
                            <div style="margin-top: 25px;">
                                <h5 style="color: #495057; margin-bottom: 15px; font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                    <span style="background: #667eea; color: white; width: 28px; height: 28px; border-radius: 6px; display: inline-flex; align-items: center; justify-content: center; font-size: 14px;">ğŸ’¾</span>
                                    å­˜å‚¨è®¾å¤‡é…ç½®æ¸…å•
                                </h5>
                                <table style="width: 100%; border-collapse: separate; border-spacing: 0; background: white; font-size: 13px; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                    <thead>
                                        <tr style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                            <th style="padding: 12px; text-align: left; color: white; font-weight: 600; border: none;">è®¾å¤‡åç§°</th>
                                            <th style="padding: 12px; text-align: left; color: white; font-weight: 600; border: none;">è®¾å¤‡ç±»å‹</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">å®¹é‡/æ€§èƒ½</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">æ¥å£</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">åŠŸè€—</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">æ•°é‡</th>
                                            <th style="padding: 12px; text-align: right; color: white; font-weight: 600; border: none;">å•ä»·</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${xcEquipment.filter(item => item.category === 'å­˜å‚¨è®¾å¤‡').map((item, idx) => `
                                            <tr style="border-bottom: 1px solid #dee2e6; ${idx % 2 === 0 ? 'background: #f8f9fa;' : ''}">
                                                <td style="padding: 10px; border: 1px solid #dee2e6;">
                                                    <div style="font-weight: 600; color: #333;">${item.name}</div>
                                                    <div style="font-size: 11px; color: #6c757d;">${item.vendor || '-'}</div>
                                                </td>
                                                <td style="padding: 10px; border: 1px solid #dee2e6; color: #495057;">
                                                    ${item.device_type || item.category}
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6;">
                                                    ${item.capacity ? `<div style="font-weight: 600; color: #495057;">${item.capacity}</div>` : ''}
                                                    ${item.iops ? `<div style="font-size: 11px; color: #6c757d;">IOPS: ${item.iops}</div>` : ''}
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6; font-size: 12px; color: #6c757d;">
                                                    ${item.interface || '-'}
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6; color: #6c757d;">
                                                    ${item.power_w || '-'}W
                                                </td>
                                                <td style="padding: 10px; text-align: center; font-weight: 600; border: 1px solid #dee2e6; color: #495057;">
                                                    ${item.quantity}
                                                </td>
                                                <td style="padding: 10px; text-align: right; font-weight: 600; color: #28a745; border: 1px solid #dee2e6;">
                                                    Â¥${item.unit_price.toLocaleString()}
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                            ` : ''}
                            
                            <!-- ç½‘ç»œè®¾å¤‡é…ç½®æ¸…å• -->
                            <div>
                                <h5 style="color: #495057; margin-bottom: 15px; font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                    <span style="background: #667eea; color: white; width: 28px; height: 28px; border-radius: 6px; display: inline-flex; align-items: center; justify-content: center; font-size: 14px;">ğŸŒ</span>
                                    ç½‘ç»œè®¾å¤‡é…ç½®æ¸…å•
                                </h5>
                                <table style="width: 100%; border-collapse: separate; border-spacing: 0; background: white; font-size: 13px; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                    <thead>
                                        <tr style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                            <th style="padding: 12px; text-align: left; color: white; font-weight: 600; border: none;">è®¾å¤‡åç§°</th>
                                            <th style="padding: 12px; text-align: left; color: white; font-weight: 600; border: none;">è®¾å¤‡ç±»å‹</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">ç«¯å£/æ€§èƒ½</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">ä¸Šè”</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">åŠŸè€—</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">æ•°é‡</th>
                                            <th style="padding: 12px; text-align: right; color: white; font-weight: 600; border: none;">å•ä»·</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${xcEquipment.filter(item => ['æ ¸å¿ƒäº¤æ¢æœº', 'æ¥å…¥äº¤æ¢æœº', 'å®‰å…¨é˜²ç«å¢™'].includes(item.category)).map((item, idx) => `
                                            <tr style="border-bottom: 1px solid #dee2e6; ${idx % 2 === 0 ? 'background: #f8f9fa;' : ''}">
                                                <td style="padding: 10px; border: 1px solid #dee2e6;">
                                                    <div style="font-weight: 600; color: #333;">${item.name}</div>
                                                    <div style="font-size: 11px; color: #6c757d;">${item.vendor || '-'}</div>
                                                </td>
                                                <td style="padding: 10px; border: 1px solid #dee2e6; color: #495057;">
                                                    ${item.device_type || item.category}
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6;">
                                                    ${item.ports ? `<div style="font-weight: 600; color: #495057;">${item.ports}å£</div>` : ''}
                                                    ${item.speed ? `<div style="font-size: 11px; color: #6c757d;">${item.speed}</div>` : ''}
                                                    ${item.throughput ? `<div style="font-weight: 600; color: #495057;">${item.throughput}</div>` : ''}
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6; font-size: 12px; color: #6c757d;">
                                                    ${item.uplink || '-'}
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6; color: #6c757d;">
                                                    ${item.power_w || '-'}W
                                                </td>
                                                <td style="padding: 10px; text-align: center; font-weight: 600; border: 1px solid #dee2e6; color: #495057;">
                                                    ${item.quantity}
                                                </td>
                                                <td style="padding: 10px; text-align: right; font-weight: 600; color: #28a745; border: 1px solid #dee2e6;">
                                                    Â¥${item.unit_price.toLocaleString()}
                                                </td>
                                            </tr>
                                        `).join('')}
                                        ${xcEquipment.filter(item => ['æ ¸å¿ƒäº¤æ¢æœº', 'æ¥å…¥äº¤æ¢æœº', 'å®‰å…¨é˜²ç«å¢™'].includes(item.category)).length === 0 ? `
                                            <tr>
                                                <td colspan="7" style="padding: 20px; text-align: center; color: #999;">æš‚æ— ç½‘ç»œè®¾å¤‡æ•°æ®</td>
                                            </tr>
                                        ` : ''}
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- å­˜å‚¨è®¾å¤‡é…ç½®æ¸…å•ï¼ˆå¦‚æœæœ‰ï¼‰ -->
                            ${xcEquipment.filter(item => item.category === 'å­˜å‚¨è®¾å¤‡').length > 0 ? `
                            <div style="margin-top: 25px;">
                                <h5 style="color: #495057; margin-bottom: 15px; font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                    <span style="background: #667eea; color: white; width: 28px; height: 28px; border-radius: 6px; display: inline-flex; align-items: center; justify-content: center; font-size: 14px;">ğŸ’¾</span>
                                    å­˜å‚¨è®¾å¤‡é…ç½®æ¸…å•
                                </h5>
                                <table style="width: 100%; border-collapse: separate; border-spacing: 0; background: white; font-size: 13px; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                    <thead>
                                        <tr style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                            <th style="padding: 12px; text-align: left; color: white; font-weight: 600; border: none;">è®¾å¤‡åç§°</th>
                                            <th style="padding: 12px; text-align: left; color: white; font-weight: 600; border: none;">è®¾å¤‡ç±»å‹</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">å®¹é‡/æ€§èƒ½</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">æ¥å£</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">åŠŸè€—</th>
                                            <th style="padding: 12px; text-align: center; color: white; font-weight: 600; border: none;">æ•°é‡</th>
                                            <th style="padding: 12px; text-align: right; color: white; font-weight: 600; border: none;">å•ä»·</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${xcEquipment.filter(item => item.category === 'å­˜å‚¨è®¾å¤‡').map((item, idx) => `
                                            <tr style="border-bottom: 1px solid #dee2e6; ${idx % 2 === 0 ? 'background: #f8f9fa;' : ''}">
                                                <td style="padding: 10px; border: 1px solid #dee2e6;">
                                                    <div style="font-weight: 600; color: #333;">${item.name}</div>
                                                    <div style="font-size: 11px; color: #6c757d;">${item.vendor || '-'}</div>
                                                </td>
                                                <td style="padding: 10px; border: 1px solid #dee2e6; color: #495057;">
                                                    ${item.device_type || item.category}
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6;">
                                                    ${item.capacity ? `<div style="font-weight: 600; color: #495057;">${item.capacity}</div>` : ''}
                                                    ${item.iops ? `<div style="font-size: 11px; color: #6c757d;">IOPS: ${item.iops}</div>` : ''}
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6; font-size: 12px; color: #6c757d;">
                                                    ${item.interface || '-'}
                                                </td>
                                                <td style="padding: 10px; text-align: center; border: 1px solid #dee2e6; color: #6c757d;">
                                                    ${item.power_w || '-'}W
                                                </td>
                                                <td style="padding: 10px; text-align: center; font-weight: 600; border: 1px solid #dee2e6; color: #495057;">
                                                    ${item.quantity}
                                                </td>
                                                <td style="padding: 10px; text-align: right; font-weight: 600; color: #28a745; border: 1px solid #dee2e6;">
                                                    Â¥${item.unit_price.toLocaleString()}
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                            ` : ''}
                        </div>
                        
                        <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); border-radius: 8px; border-left: 4px solid #28a745;">
                            <div style="font-weight: 600; color: #155724; margin-bottom: 8px;">âœ¨ ä¿¡åˆ›æ–¹æ¡ˆä¼˜åŠ¿</div>
                            <ul style="margin: 0; padding-left: 20px; color: #155724;">
                                <li>æˆæœ¬èŠ‚çº¦ï¼šå•å°è®¾å¤‡å¹³å‡èŠ‚çº¦ 8-12%</li>
                                <li>è‡ªä¸»å¯æ§ï¼šæ ¸å¿ƒæŠ€æœ¯å®Œå…¨æŒæ¡ï¼Œæ— åé—¨é£é™©</li>
                                <li>æ”¿ç­–æ”¯æŒï¼šç¬¦åˆå›½å®¶ä¿¡åˆ›è¦æ±‚ï¼Œäº«å—æ”¿åºœè¡¥è´´</li>
                                <li>æœ¬åœŸæœåŠ¡ï¼šå”®åå“åº”å¿«ï¼ŒæŠ€æœ¯æ”¯æŒåŠæ—¶</li>
                                <li>æŒç»­ä¼˜åŒ–ï¼šå›½äº§å“ç‰Œå¿«é€Ÿè¿­ä»£ï¼Œæ€§ä»·æ¯”æŒç»­æå‡</li>
                            </ul>
                        </div>
                    </div>
                `;
            }

            resultsContent.innerHTML = `
                ${xinchuanComparisonHTML}
                ${xinchuanEquipmentHTML}
                
                ${r.xinchuan_enabled ? `
                <div style="margin: 40px 0; padding: 0; position: relative;">
                    <div style="height: 3px; background: linear-gradient(90deg, 
                        rgba(102, 126, 234, 0) 0%, 
                        rgba(102, 126, 234, 0.3) 10%, 
                        rgba(102, 126, 234, 0.8) 30%, 
                        #667eea 50%, 
                        rgba(102, 126, 234, 0.8) 70%, 
                        rgba(102, 126, 234, 0.3) 90%, 
                        rgba(102, 126, 234, 0) 100%); 
                        border-radius: 2px;"></div>
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
                        color: white; 
                        padding: 8px 24px; 
                        border-radius: 20px; 
                        font-weight: 700; 
                        font-size: 14px; 
                        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
                        letter-spacing: 1px;">
                        â¬‡ï¸ éä¿¡åˆ›ä¼ ç»Ÿæ–¹æ¡ˆ â¬‡ï¸
                    </div>
                </div>
                ` : ''}
                
                <div class="result-card">
                    <h3>ğŸ—ï¸ æ¶æ„æ–¹æ¡ˆ${r.xinchuan_enabled ? ' (éä¿¡åˆ›æ–¹æ¡ˆ)' : ''}</h3>
                    <div class="result-grid">
                        <div class="result-item">
                            <label>æ¶æ„ç±»å‹</label>
                            <value>${arch.description || mapped.architecture_type}</value>
                        </div>
                        <div class="result-item">
                            <label>æ€»èŠ‚ç‚¹æ•°</label>
                            <value>${mapped.node_count}</value>
                        </div>
                        <div class="result-item">
                            <label>åˆ†ç‰‡æ•°é‡</label>
                            <value>${mapped.shard_count}</value>
                        </div>
                        <div class="result-item">
                            <label>å‰¯æœ¬æ•°é‡</label>
                            <value>${mapped.replica_count}</value>
                        </div>
                    </div>
                    <div class="result-grid" style="margin-top: 15px;">
                        <div class="result-item">
                            <label>æ•°æ®åº“èŠ‚ç‚¹</label>
                            <value>${topo.db_nodes || 0}</value>
                        </div>
                        <div class="result-item">
                            <label>ä»£ç†èŠ‚ç‚¹</label>
                            <value>${topo.proxy_nodes || 0}</value>
                        </div>
                        <div class="result-item">
                            <label>åº”ç”¨èŠ‚ç‚¹</label>
                            <value>${topo.app_nodes || 0}</value>
                        </div>
                        <div class="result-item">
                            <label>ç›‘æ§/å¤‡ä»½èŠ‚ç‚¹</label>
                            <value>${(topo.monitor_nodes || 0) + (topo.backup_nodes || 0)}</value>
                        </div>
                    </div>
                </div>

                <div class="result-card">
                    <h3>ğŸ’° æˆæœ¬æ€»è§ˆ${r.xinchuan_enabled ? ' (éä¿¡åˆ›æ–¹æ¡ˆ)' : ''}</h3>
                    <div class="result-grid">
                        <div class="result-item">
                            <label>åˆå§‹æŠ•èµ„</label>
                            <value style="color: #667eea; font-size: 20px; font-weight: bold;">Â¥${Number(cost.initial_investment || 0).toLocaleString()}</value>
                        </div>
                        <div class="result-item">
                            <label>ä¸‰å¹´TCO</label>
                            <value style="color: #764ba2; font-size: 20px; font-weight: bold;">Â¥${Number(mapped.total_cost).toLocaleString()}</value>
                        </div>
                        <div class="result-item">
                            <label>å¹´åº¦è¿è¥æˆæœ¬</label>
                            <value>Â¥${Number(mapped.ops_cost).toLocaleString()}</value>
                        </div>
                        <div class="result-item">
                            <label>æœˆåº¦è¿è¥æˆæœ¬</label>
                            <value>Â¥${Number(cost.monthly_operating || 0).toLocaleString()}</value>
                        </div>
                    </div>
                </div>

                <div class="result-card">
                    <h3>ğŸ–¥ï¸ æœåŠ¡å™¨é…ç½®æ¸…å•${r.xinchuan_enabled ? ' (éä¿¡åˆ›æ–¹æ¡ˆ)' : ''}</h3>
                    <p style="color: #666; margin-bottom: 10px;">å…± ${equipment.servers ? equipment.servers.length : 0} å°æœåŠ¡å™¨</p>
                    ${serversHTML}
                </div>

                <div class="result-card">
                    <h3>ğŸŒ ç½‘ç»œè®¾å¤‡æ¸…å•${r.xinchuan_enabled ? ' (éä¿¡åˆ›æ–¹æ¡ˆ)' : ''}</h3>
                    <p style="color: #666; margin-bottom: 10px;">å…± ${equipment.network_devices ? equipment.network_devices.length : 0} å°ç½‘ç»œè®¾å¤‡</p>
                    ${networkHTML}
                </div>

                <div class="result-card">
                    <h3>ğŸ’¾ å­˜å‚¨è®¾å¤‡æ¸…å•${r.xinchuan_enabled ? ' (éä¿¡åˆ›æ–¹æ¡ˆ)' : ''}</h3>
                    ${storageHTML}
                </div>

                <div class="result-card">
                    <h3>ğŸ¢ åŸºç¡€è®¾æ–½æ¸…å•${r.xinchuan_enabled ? ' (éä¿¡åˆ›æ–¹æ¡ˆ)' : ''}</h3>
                    ${infraHTML}
                </div>

                <div class="result-card">
                    <h3>ğŸ“Š è¯¦ç»†æŠ¥ä»·å•${r.xinchuan_enabled ? ' (éä¿¡åˆ›æ–¹æ¡ˆ)' : ''}</h3>
                    ${quotationHTML}
                </div>

                <div class="result-card">
                    <h3>ğŸ“¥ å¯¼å‡ºé€‰é¡¹</h3>
                    <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                        <button class="btn btn-primary" onclick="exportToExcel()">ğŸ“„ å¯¼å‡ºExcelæŠ¥ä»·å•</button>
                        <button class="btn btn-secondary" onclick="exportToPDF()">ğŸ“‘ å¯¼å‡ºPDFæ–¹æ¡ˆä¹¦</button>
                        <button class="btn btn-secondary" onclick="window.print()">ğŸ–¨ï¸ æ‰“å°æŠ¥å‘Š</button>
                    </div>
                </div>
            `;

            // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        }
        
        // å¯¼å‡ºExcelåŠŸèƒ½
        function exportToExcel() {
            alert('Excelå¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼');
            // TODO: å®ç°Excelå¯¼å‡º
        }
        
        // å¯¼å‡ºPDFåŠŸèƒ½
        function exportToPDF() {
            alert('PDFå¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼');
            // TODO: å®ç°PDFå¯¼å‡º
        }

        // è¿”å›é¡¶éƒ¨
        window.addEventListener('scroll', () => {
            const backToTop = document.getElementById('backToTop');
            if (window.pageYOffset > 300) {
                backToTop.classList.add('show');
            } else {
                backToTop.classList.remove('show');
            }
        });

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
