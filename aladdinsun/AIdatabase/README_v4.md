# TDSQL 部署资源预测系统 v4.0

## 📋 系统简介

TDSQL 部署资源预测系统是一款智能化的数据库部署规划工具，能够根据业务需求自动生成详细的部署方案，包括：

- 🏗️ **架构设计** - 自动设计分片、副本、高可用架构
- 🖥️ **设备清单** - 详细的服务器、网络设备、存储设备清单
- 🌐 **网络拓扑** - 完整的网络分层架构和VLAN规划
- 💰 **成本分析** - 硬件、软件、服务、运营成本详细分解
- 📊 **架构图** - 可视化的系统架构拓扑图
- 💡 **部署建议** - 专业的性能优化和安全加固建议

## 🚀 快速开始

### 1. 环境要求

- Python 3.7+
- 浏览器（Chrome、Firefox、Safari等）

### 2. 安装依赖

```bash
pip install -r requirements.txt
```

### 3. 启动服务

```bash
# 方式1: 使用启动脚本
chmod +x start_predictor.sh
./start_predictor.sh

# 方式2: 直接运行
python3 app.py
```

### 4. 访问系统

打开浏览器访问：http://127.0.0.1:5173

## 📖 使用指南

### 方式一：手动输入参数

1. 在表单中填写业务参数：
   - **QPS** (必填) - 每秒查询数
   - **数据量** (必填) - 当前数据总量(GB)
   - **高可用级别** (必填) - 选择高/中/低
   - **TPS** - 每秒事务数
   - **并发用户数** - 同时在线用户数
   - **数据增长率** - 年增长率
   - **行业类型** - 选择所属行业
   - **峰值QPS** - 业务高峰期QPS

2. 点击"开始预测"按钮

3. 查看预测结果

### 方式二：文件上传（自动提取参数）

1. 点击文件上传区域或拖拽文件
2. 支持的文件格式：
   - **Excel** (.xlsx, .xls) - 自动解析表格数据
   - **JSON** (.json) - 直接读取参数
   - **图片** (.png, .jpg, .jpeg) - OCR识别文本
   - **PDF** (.pdf) - 提取文本内容
   - **文本** (.txt) - 文本解析

3. 系统自动提取参数并填充表单
4. 可手动修改自动填充的参数
5. 点击"开始预测"

## 📊 预测结果说明

### 1. 概览

显示系统规模、QPS、数据量、服务器数量、初始投资、3年TCO等关键指标。

### 2. 架构设计

- **架构类型**：单主从、分片集群、分布式集群
- **拓扑配置**：分片数、副本数、各类节点数量
- **高可用配置**：故障转移、备份策略、容灾方案

### 3. 设备清单

#### 服务器清单
- 编号、角色、型号
- CPU、内存、存储配置
- 网络接口、单价、功耗

#### 网络设备清单
- 核心交换机（双机热备）
- 接入交换机
- 防火墙（双机热备）
- 负载均衡器（双机热备）
- 路由器

#### 存储设备清单
- SSD/HDD类型
- 容量、IOPS、吞吐量

#### 基础设施清单
- 机柜、PDU、UPS
- 网线及配件

### 4. 网络拓扑

- **分层架构**：
  - Internet接入层
  - DMZ安全区
  - 核心交换层
  - 接入交换层
  - 应用服务层
  - TDSQL代理层
  - 数据库层
  - 管理监控层

- **VLAN划分**：
  - VLAN 10: DMZ (10.0.10.0/24)
  - VLAN 20: APP (10.0.20.0/24)
  - VLAN 30: PROXY (10.0.30.0/24)
  - VLAN 40: DB (10.0.40.0/24)
  - VLAN 50: MGMT (10.0.50.0/24)

### 5. 成本分析

#### 初始投资
- **硬件成本**：服务器、网络设备、存储、基础设施
- **软件许可证**：TDSQL、操作系统、监控、备份
- **服务费用**：部署实施、技术培训

#### 年度运营成本
- **电费**：基于设备功耗计算
- **制冷费用**：电费的40%
- **软件维护**：许可证年度维护费

#### TCO (Total Cost of Ownership)
- 3年总拥有成本
- 月度运营成本

### 6. 架构图

可视化展示系统架构拓扑，包括所有节点和连接关系。

### 7. 部署建议

根据系统规模和配置，提供：
- 性能优化建议
- 高可用配置建议
- 监控运维建议
- 安全加固建议
- 数据备份建议
- 容量规划建议

## 🔧 配置说明

### 服务器规格库

系统内置多种服务器规格：

- **db_small**: Dell PowerEdge R440 (8核/32GB/1TB)
- **db_medium**: Dell PowerEdge R640 (16核/64GB/2TB)
- **db_large**: Dell PowerEdge R740 (32核/128GB/4TB)
- **db_xlarge**: Dell PowerEdge R940 (64核/256GB/8TB)
- **app_server**: Dell PowerEdge R340 (4核/16GB/500GB)
- **proxy_server**: Dell PowerEdge R340 (8核/32GB/500GB)
- **monitor_server**: Dell PowerEdge R340 (4核/16GB/1TB)

### 网络设备库

- **核心交换机**: Cisco Nexus 93180YC-FX / 9336C-FX2
- **接入交换机**: Cisco Catalyst 2960-X / 9300
- **防火墙**: Fortinet FortiGate 600E
- **负载均衡器**: F5 BIG-IP 4200v
- **路由器**: Cisco ASR 1001-X

### 规模等级

系统根据QPS和数据量自动判断规模：

- **Small**: QPS < 1000, 数据量 < 100GB
- **Medium**: QPS < 5000, 数据量 < 1TB
- **Large**: QPS < 20000, 数据量 < 10TB
- **XLarge**: QPS ≥ 20000 或 数据量 ≥ 10TB

## 📁 文件上传格式示例

### Excel格式

| 参数名称 | 参数值 |
|---------|--------|
| QPS | 5000 |
| TPS | 1500 |
| 数据量(GB) | 500 |
| 并发用户数 | 1000 |
| 行业 | 金融 |
| 高可用级别 | high |

### JSON格式

```json
{
  "qps": 5000,
  "tps": 1500,
  "data_volume": 500,
  "concurrent_users": 1000,
  "industry": "finance",
  "ha_level": "high",
  "data_growth_rate": 0.3
}
```

## 🎯 典型应用场景

### 场景1：小型电商系统

- QPS: 1000
- 数据量: 50GB
- 高可用: 中
- 预测结果: 单主从架构，4台服务器，初始投资约15万

### 场景2：中型金融系统

- QPS: 5000
- 数据量: 500GB
- 高可用: 高
- 预测结果: 2分片集群，12台服务器，初始投资约80万

### 场景3：大型互联网平台

- QPS: 20000
- 数据量: 5TB
- 高可用: 高
- 预测结果: 4分片集群，28台服务器，初始投资约300万

## 🔍 技术特点

### 1. 智能参数提取

- 支持多种文件格式
- OCR图片识别
- 自动参数映射
- 智能默认值

### 2. 精准资源计算

- 基于经验公式的CPU/内存估算
- IOPS和带宽需求计算
- 3年容量规划
- 冗余和高可用考虑

### 3. 详细成本分析

- 硬件采购成本
- 软件许可证成本
- 部署实施成本
- 年度运营成本
- 3年TCO计算

### 4. 专业架构设计

- 分片策略
- 副本配置
- 网络分层
- VLAN规划
- 高可用方案

## 📞 技术支持

如有问题或建议，请联系技术支持团队。

## 📝 更新日志

### v4.0 (2025-10-25)

- ✨ 全新的"部署资源预测"系统
- 🎨 重新设计的用户界面
- 📁 集成文件上传功能到主页面
- 📊 增强的设备清单（服务器、交换机、存储等）
- 💰 详细的成本清单（硬件、软件、服务、运营）
- 🌐 完整的网络拓扑设计
- 🏗️ 架构图可视化
- 💡 专业的部署建议

### v3.2 (之前版本)

- 融合手动输入和文件上传
- 图片OCR识别
- PDF文件解析

## 📄 许可证

Copyright © 2025 TDSQL Team. All rights reserved.
