# 📤 图像表格智能识别功能说明

## 🎯 功能概述

TDSQL架构智能预测系统现已支持**图像和Excel文件的智能识别**功能，您只需上传截图或Excel文件，系统将自动提取数据并填充表单。

---

## 🚀 支持的文件类型

### 1. 图片格式
- ✅ PNG (.png)
- ✅ JPEG (.jpg, .jpeg)
- ✅ GIF (.gif)
- ✅ BMP (.bmp)

### 2. Excel格式
- ✅ Excel 2007+ (.xlsx)
- ✅ Excel 97-2003 (.xls)

**文件大小限制**: 最大 16MB

---

## 📋 使用场景

### 场景一：预测分析
在"📊 预测分析"标签页中：
1. 点击"📁 选择文件（图片/Excel）"按钮
2. 选择包含数据库参数的截图或Excel文件
3. 系统自动识别并填充表单
4. 检查并补充信息后，点击"📝 开始预测"

### 场景二：提交案例
在"📝 提交案例"标签页中：
1. 点击"📁 选择案例文件"按钮
2. 上传包含实际部署数据的文件
3. 系统自动填充案例表单
4. 补充说明后，点击"✅ 提交案例"

---

## 📊 Excel模板格式

### 预测分析模板 (`database_migration_template.xlsx`)

| 参数名称 | 参数值 | 说明 |
|---------|--------|------|
| 数据总量 | 8640.87 GB | 当前数据库总数据量 |
| 表数量 | 150 | 所有表的总数 |
| QPS | 50000 | 每秒查询次数 |
| TPS | 20000 | 每秒事务数 |
| 并发连接数 | 5000 | 最大并发连接数 |
| 数据增长率 | 30% | 年数据增长率 |
| 高可用 | 是 | 是否需要高可用部署 |

### 案例提交模板 (`case_submission_template.xlsx`)

| 输入参数 | 参数值 | 实际架构 | 架构值 |
|---------|--------|---------|--------|
| 数据总量 (GB) | 10000 | 架构类型 | distributed |
| QPS | 80000 | 节点数量 | 8 |
| 表数量 | 200 | 分片数量 | 4 |
| 并发连接数 | 8000 | 副本数量 | 2 |

---

## 🔍 智能识别原理

### 图片识别流程
1. **图像预处理**: 灰度化、二值化、去噪
2. **OCR文字识别**: 使用Tesseract引擎识别中英文
3. **关键词匹配**: 智能匹配数据库参数关键词
4. **数据提取**: 提取数字、单位、布尔值
5. **结构化输出**: 转换为标准JSON格式

### Excel识别流程
1. **文件解析**: 使用pandas读取Excel内容
2. **单元格遍历**: 扫描所有列和行
3. **语义理解**: 识别参数名称和对应值
4. **数据验证**: 检查数据类型和范围
5. **自动填充**: 填充到对应表单字段

---

## 🎨 识别关键词映射

系统能识别以下关键词（中英文）：

| 参数类型 | 识别关键词 |
|---------|-----------|
| 数据量 | 数据量、数据总量、总数据、data size、容量、GB、TB |
| 表数量 | 表数量、表个数、表总数、table count、tables |
| QPS | QPS、qps、每秒查询、queries per second |
| TPS | TPS、tps、每秒事务、transactions per second |
| 连接数 | 连接数、并发连接、connections、concurrent |
| 架构 | 架构、架构类型、architecture、部署方式 |
| 节点 | 节点、节点数、nodes、服务器数 |
| 高可用 | 高可用、HA、high availability |
| 容灾 | 容灾、DR、disaster recovery |

---

## 💡 使用技巧

### 1. 图片上传建议
- ✅ 使用清晰的截图，避免模糊
- ✅ 确保文字清晰可读
- ✅ 表格结构清晰，行列对齐
- ✅ 避免复杂背景和干扰元素

### 2. Excel文件建议
- ✅ 使用简洁的表格结构
- ✅ 参数名称和值放在相邻单元格
- ✅ 使用标准的参数名称
- ✅ 数值带上单位（如 GB、%）

### 3. 识别后检查
- ⚠️ 识别结果可能不完全准确
- ⚠️ 请务必检查自动填充的数据
- ⚠️ 补充缺失的参数
- ⚠️ 修正识别错误的值

---

## 🛠️ 技术栈

- **OCR引擎**: Tesseract (支持中英文)
- **图像处理**: OpenCV, Pillow
- **Excel解析**: pandas, openpyxl
- **文本提取**: 正则表达式、关键词匹配
- **前端上传**: HTML5 File API, FormData

---

## 📝 示例

### 示例1: 上传数据库清单截图
```
数据库迁移清单
━━━━━━━━━━━━━━━━━━━━
数据总量: 8640.87 GB
表数量: 150
QPS: 50000
TPS: 20000
并发连接数: 5000
需要高可用: 是
```

**识别结果**:
- 数据总量: 8640.87 GB ✅
- 表数量: 150 ✅
- QPS: 50000 ✅
- TPS: 20000 ✅
- 并发连接数: 5000 ✅
- 高可用: 是 ✅

### 示例2: 上传Excel文件
使用提供的模板文件 `database_migration_template.xlsx`，系统将自动识别所有参数。

---

## ⚙️ 降级方案

如果OCR库未安装或识别失败，系统将：
1. 使用模拟数据作为示例
2. 提示用户手动输入
3. 保证系统正常运行

---

## 🎯 下一步优化

- [ ] 支持PDF文件识别
- [ ] 支持表格区域自动检测
- [ ] 支持多语言识别（日文、韩文等）
- [ ] 提高识别准确率（深度学习模型）
- [ ] 支持手写文字识别
- [ ] 批量文件上传

---

## 📞 反馈与建议

如果您在使用过程中遇到问题或有改进建议，请通过"💬 反馈优化"标签页提交反馈。

**祝您使用愉快！** 🎉
